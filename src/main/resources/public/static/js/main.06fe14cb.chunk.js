(this.webpackJsonpsterling=this.webpackJsonpsterling||[]).push([[0],{320:function(e,t,n){e.exports=n(886)},885:function(e,t,n){},886:function(e,t,n){"use strict";n.r(t);var a=n(47),i=n(0),r=n.n(i),l=n(31),o=n.n(l),s=n(14),c=n(3),u=n(8),h=n(7),d=n(9),f=n(4),p=n(26),g=function(){function e(){Object(c.a)(this,e),this._listeners=void 0}return Object(f.a)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t),this}},{key:"dispatchEvent",value:function(e){var t=this;if(void 0===this._listeners)return this;var n=this._listeners[e.type];void 0!==n&&(e.target=this,n.slice().forEach((function(n){n.call(t,e)})));return this}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0===this._listeners)return this;var n=this._listeners[e];if(void 0!==n){var a=n.indexOf(t);-1!==a&&n.splice(a,1)}return this}}]),e}(),m=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this)))._url=void 0,n._ws=void 0,n._auto_reconnect=void 0,n._auto_reconnect_interval=void 0,n._connected=void 0,n._heartbeat_count=void 0,n._heartbeat_id=void 0,n._heartbeat_interval=void 0,n._heartbeat_latency=void 0,n._heartbeat_timestamp=void 0,n._url=e,n._ws=null,n._auto_reconnect=!1,n._auto_reconnect_interval=5e3,n._connected=!1,n._heartbeat_count=0,n._heartbeat_id=0,n._heartbeat_interval=15e3,n._heartbeat_latency=0,n._heartbeat_timestamp=0,n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"connect",value:function(){this._ws&&(this._ws.onclose=null,this._ws.close()),this._initializeConnection()}},{key:"requestCurrentInstance",value:function(){return this._request("current")}},{key:"requestEvaluateExpression",value:function(e,t){return this._request("EVL:".concat(e,":").concat(t))}},{key:"requestNextInstance",value:function(){return this._request("next")}},{key:"_handleEval",value:function(e){this.dispatchEvent({type:"eval",data:e})}},{key:"_handlePong",value:function(){this._heartbeat_latency+=performance.now()-this._heartbeat_timestamp,this._heartbeat_count+=1}},{key:"_handleXML",value:function(e){if(e.length)try{this.dispatchEvent({type:"instance",instance:new p.a(e)})}catch(t){this.dispatchEvent({type:"error",message:"Invalid instance data"})}}},{key:"_initializeConnection",value:function(){this._ws=new WebSocket(this._url),this._ws.onopen=this._onOpen.bind(this),this._ws.onclose=this._onClose.bind(this),this._ws.onerror=this._onError.bind(this),this._ws.onmessage=this._onMessage.bind(this)}},{key:"_onClose",value:function(e){this._connected=!1,this._ws=null,this._auto_reconnect&&this._reconnect(),this.dispatchEvent({type:"disconnect"})}},{key:"_onError",value:function(e){this.dispatchEvent({type:"error"})}},{key:"_onMessage",value:function(e){this._resetHeartbeat();var t=e.data.slice(0,4),n=e.data.slice(4);switch(t){case"pong":this._handlePong();break;case"EVL:":this._handleEval(n);break;case"XML:":this._handleXML(n);break;default:this.dispatchEvent({type:"error",message:"Unknown response header: ".concat(t)})}}},{key:"_onOpen",value:function(e){this._connected=!0,this._resetHeartbeat(),this.dispatchEvent({type:"connect"})}},{key:"_ping",value:function(){this._ws&&(this._heartbeat_timestamp=performance.now(),this._ws.send("ping"))}},{key:"_reconnect",value:function(){window.setTimeout(this._initializeConnection.bind(this),this._auto_reconnect_interval)}},{key:"_request",value:function(e){return!(!this._connected||!this._ws)&&(this._ws.send(e),!0)}},{key:"_resetHeartbeat",value:function(){clearTimeout(this._heartbeat_id),this._heartbeat_id=window.setTimeout(this._ping.bind(this),this._heartbeat_interval)}}]),t}(g),v=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).call(this,"ws://"+window.location.hostname+":"+window.location.port+"/alloy"))}return Object(d.a)(t,e),t}(m),b=function e(){Object(c.a)(this,e)},y=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this)))._cx=0,e._cy=0,e._radius=250,e}return Object(d.a)(t,e),Object(f.a)(t,[{key:"apply",value:function(e){var t=e.boundingBox(),n=(t[1]+t[3])/2,a=(t[0]+t[2])/2,i=Math.abs(t[1]-t[3]),r=Math.abs(t[0]-t[2]),l=.8*Math.min(i,r)/2,o=e.nodes(),s=2*Math.PI/o.length;o.forEach((function(e,t){e.x=n+l*Math.cos(t*s),e.y=a+l*Math.sin(t*s)}))}},{key:"cx",value:function(e){return arguments.length?(this._cx=e,this):this._cx}},{key:"cy",value:function(e){return arguments.length?(this._cy=e,this):this._cy}},{key:"radius",value:function(e){return arguments.length?(this._radius=e,this):this._radius}}]),t}(b),_=n(169),k=n(38);function S(e,t,n){Object(k.defaults)(e,Object(k.pick)(Object(k.cloneDeep)(t),n))}function E(e,t){S(e,t,["fill","stroke","strokeDash","strokeWidth"])}function x(e){var t={};return j(e)&&(t=function(e){return Object(k.pick)(e,["type","radius"])}(e)),O(e)&&(t=function(e){return Object(k.pick)(e,["type","width","height"])}(e)),E(t,e),t}function j(e){return"circle"===e.type}function O(e){return"rectangle"===e.type}var w=n(23),C=function(){function e(t,n,a,i){Object(c.a)(this,e),this._xmin=void 0!==t?t:1/0,this._ymin=void 0!==n?n:1/0,this._xmax=void 0!==a?a:-1/0,this._ymax=void 0!==i?i:-1/0}return Object(f.a)(e,[{key:"bounds",value:function(){return[[this._xmin,this._ymin],[this._xmax,this._ymax]]}},{key:"clone",value:function(){return new e(this._xmin,this._ymin,this._xmax,this._ymax)}},{key:"expand",value:function(t,n){return t instanceof e?this._expandBBox(t):(void 0!==n&&this._expandPoint(t,n),this)}},{key:"_expandBBox",value:function(e){var t=e.bounds(),n=Object(w.a)(t,2),a=Object(w.a)(n[0],2),i=a[0],r=a[1],l=Object(w.a)(n[1],2),o=l[0],s=l[1];return i<this._xmin&&(this._xmin=i),r<this._ymin&&(this._ymin=r),o>this._xmax&&(this._xmax=o),s>this._ymax&&(this._ymax=s),this}},{key:"_expandPoint",value:function(e,t){return e<this._xmin&&(this._xmin=e),e>this._xmax&&(this._xmax=e),t<this._ymin&&(this._ymin=t),t>this._ymax&&(this._ymax=t),this}}]),e}(),M=function e(){Object(c.a)(this,e)},T=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this)))._nodes=[],n.fill=t.defaultFill,n.stroke=t.defaultStroke,n.strokeDash=t.defaultStrokeDash,n.strokeWidth=t.defaultStrokeWidth,e&&(void 0!==e.fill&&(n.fill=e.fill),void 0!==e.stroke&&(n.stroke=e.stroke),void 0!==e.strokeDash&&(n.strokeDash=e.strokeDash.slice()),void 0!==e.strokeWidth&&(n.strokeWidth=e.strokeWidth)),n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"nodes",value:function(e){return arguments.length?(this._nodes=e,this):this._nodes}},{key:"_doStrokeAndFill",value:function(e){this.strokeDash&&e.setLineDash(this.strokeDash),null!==this.strokeWidth&&(e.lineWidth=this.strokeWidth),this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&this.strokeWidth&&(e.strokeStyle=this.stroke,e.stroke())}}]),t}(M);T.defaultFill="white",T.defaultStroke="#333333",T.defaultStrokeDash=null,T.defaultStrokeWidth=1.5;var L=2*Math.PI,D=Math.PI/3,R=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e)))._width=t.defaultWidth,n._height=t.defaultHeight,e&&O(e)&&(e.width&&(n._width=e.width),e.height&&(n._height=e.height)),n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"bounds",value:function(e,t){var n=this,a=new C;return this._nodes.forEach((function(i){var r=e(i.x),l=t(i.y);a.expand(r+n._width/2,l+n._height/2),a.expand(r-n._width/2,l-n._height/2)})),a}},{key:"containsPoint",value:function(e,t,n,a){a=a||1;var i=this._width/a/2,r=this._height/a/2,l=e.y+r,o=e.x+i,s=e.y-r,c=e.x-i;return o>=t&&t>=c&&l>=n&&n>=s}},{key:"height",value:function(e){return arguments.length?(this._height=+e,this):this._height}},{key:"intersect",value:function(e){for(;e<-Math.PI;)e+=L;for(;e>Math.PI;)e-=L;var t=Math.tan(e),n=function(e,t,n){var a=Math.atan2(n,t);return e>-a&&e<=a?1:e>a&&e<=Math.PI-a?2:e>Math.PI-a||e<=-(Math.PI-a)?3:4}(e,this._width,this._height),a=1===n||2===n?1:-1,i=3===n||4===n?-1:1;return 1===n||3===n?(a*=this._width/2,i*=t*this._width/2):(a*=this._height/(2*t),i*=this._height/2),{x:a,y:i}}},{key:"render",value:function(e,t,n){var a=this;if(this._nodes.length){e.save(),e.beginPath();var i=this._width/2,r=this._height/2;this._nodes.forEach((function(l){var o=t(l.x),s=n(l.y);e.rect(Math.round(o-i)-.5,Math.round(s-r)-.5,a._width+1,a._height+1)})),this._doStrokeAndFill(e),e.restore()}}},{key:"selfLoopPoints",value:function(e){var t=e.x,n=e.y,a=Math.max(100,Math.min(this._width,200)),i=Math.min(this._height,100),r=this._width/2,l=i/4;return[{x:t,y:n,dx:r,dy:-l},{x:t,y:n,dx:r+a*Math.cos(-D),dy:i*Math.sin(-D)},{x:t,y:n,dx:r+a*Math.cos(D),dy:i*Math.sin(D)},{x:t,y:n,dx:r,dy:l}]}},{key:"width",value:function(e){return arguments.length?(this._width=+e,this):this._width}}]),t}(T);R.defaultWidth=125,R.defaultHeight=60;var N=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(f.a)(t,[{key:"apply",value:function(e,t){var n=new _.graphlib.Graph({multigraph:!0});n.setGraph(t||{nodesep:2*R.defaultWidth,ranksep:2*R.defaultWidth,rankdir:"BT"}),n.setDefaultEdgeLabel((function(){return{}})),e.nodes().forEach((function(e){n.setNode(e.id,{label:e.id,width:R.defaultWidth,height:R.defaultHeight})})),e.edges().forEach((function(e){n.setEdge(e.source,e.target)})),Object(_.layout)(n);var a=new Map(e.nodes().map((function(e){return[e.id,e]}))),i=n.graph(),r=i.width?i.width/2:0,l=i.height?i.height/2:0;n.nodes().forEach((function(e){var t=a.get(e);if(t){var i=n.node(t.id);t.x=i.x-r,t.y=i.y-l}}))}}]),t}(b),A=n(19),F=n(52),V=function(){function e(){Object(c.a)(this,e)}return Object(f.a)(e,[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;return void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t),this}},{key:"dispatchEvent",value:function(e){var t=this;if(void 0===this._listeners)return this;var n=this._listeners[e.type];void 0!==n&&(e.target=this,n.slice().forEach((function(n){n.call(t,e)})));return this}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0===this._listeners)return this;var n=this._listeners[e];if(void 0!==n){var a=n.indexOf(t);-1!==a&&n.splice(a,1)}return this}}]),e}(),P=function(e){function t(e,n,a){var i;Object(c.a)(this,t),(i=Object(u.a)(this,Object(h.a)(t).call(this)))._canvas=e,i._quadtree=A.d(),i._renderers=new Map,i._transform=A.h,i._x=n,i._y=a;var r=A.a().container(e).subject(i._dragSubject.bind(Object(F.a)(i))).on("start",i._dragStart.bind(Object(F.a)(i))).on("drag",i._drag.bind(Object(F.a)(i))).on("end",i._dragEnd.bind(Object(F.a)(i)));return A.f(e).call(r),i}return Object(d.a)(t,e),Object(f.a)(t,[{key:"boundingBox",value:function(){return this._quadtree.extent()}},{key:"setShapes",value:function(e){var t=this;this._renderers=new Map;var n=e.map((function(e){return e.nodes()})).reduce((function(e,t){return e.concat(t)}),[]);return e.forEach((function(e){e.nodes().forEach((function(n){t._renderers.set(n,e)}))})),this._quadtree=A.d().x((function(e){return e.x})).y((function(e){return e.y})).addAll(n),this}},{key:"setTransform",value:function(e){return this._transform=e,this}},{key:"_drag",value:function(){var e=A.c(this._canvas),t=A.b.subject,n=this._transform.invertX(e[0]),a=this._transform.invertY(e[1]),i=this._x.invert(n),r=this._y.invert(a);t.x=i,t.y=r,this.dispatchEvent({type:"drag",node:t})}},{key:"_dragEnd",value:function(){this._quadtree.add(A.b.subject),this.dispatchEvent({type:"end"})}},{key:"_dragStart",value:function(){this._quadtree.remove(A.b.subject)}},{key:"_dragSubject",value:function(e,t,n){var a=this._transform.invertX(A.b.x),i=this._transform.invertY(A.b.y),r=this._x.invert(a),l=this._y.invert(i);return this._findNode(r,l)||e}},{key:"_findNode",value:function(e,t){var n=this._quadtree.find(e,t);if(n){var a=this._renderers.get(n);if(a&&a.containsPoint(n,e,t,this._transform.k))return n}}}]),t}(V),I=n(57),z=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this)))._linkMap=new Map,e._placement="spread",e}return Object(d.a)(t,e),Object(f.a)(t,[{key:"getPlacement",value:function(){return this._placement}},{key:"setLinkMap",value:function(e){this._linkMap=e}},{key:"setPlacement",value:function(e){this._placement=e}},{key:"update",value:function(){"center"===this._placement&&this._buildCenterLabels(),"join"===this._placement&&this._buildJoinLabels(),"spread"===this._placement&&this._buildSpreadLabels()}},{key:"_bezierBounds",value:function(e){if(e<1)return[.5,0];var t=Math.min(.8/(e-1),.1);return[.5-Math.min(t*(e-1),.8)/2,t]}},{key:"_buildCenterLabels",value:function(){this._linkMap.forEach((function(e,t){t.labels=e.filter((function(e){return Object(I.isDefined)(e.label)})).map((function(e){return{t:.5,text:e.label}}))}))}},{key:"_buildJoinLabels",value:function(){this._linkMap.forEach((function(e,t){t.labels=[{text:W(e),t:.5}]}))}},{key:"_buildSpreadLabels",value:function(){var e=this;this._linkMap.forEach((function(t,n){if(t.length){var a=e._bezierBounds(t.length),i=Object(w.a)(a,2),r=i[0],l=i[1];n.labels=t.filter((function(e){return Object(I.isDefined)(e.label)})).map((function(e,t){return{t:r+t*l,text:e.label}}))}}))}}]),t}((function e(){Object(c.a)(this,e)}));function W(e){return e.map((function(e){return e.label})).filter(I.isDefined).join(", ")}var H=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this)))._links=[],n._color=t.defaultColor,n._font=t.defaultFont,n._highlight=null,e&&(e.color&&(n._color=e.color),e.font&&(n._font=e.font)),n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"highlight",value:function(e){this._highlight=e}},{key:"links",value:function(e){return arguments.length?(this._links=e,this):this._links}},{key:"render",value:function(e,t,n){if(this._links.length){var a=null===this._highlight?this._links:this._links.includes(this._highlight)?[this._highlight]:[];a.length&&(e.save(),e.beginPath(),this._color&&(e.fillStyle=this._color),e.font=this._font,e.textAlign="center",e.textBaseline="middle",a.forEach((function(a){var i=a.path;i&&a.labels.forEach((function(a){var r=i.pointAlong(a.t,t,n);e.fillText(a.text,r.x,r.y)}))})))}}}]),t}(M);H.defaultColor="#333333",H.defaultFont="14px sans-serif";var B=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this)))._links=[],n.stroke="#333333",n.strokeDash=null,n.strokeWidth=null,n.lowlightStroke="#777777",n.lowlightWidth=1,e&&(e.stroke&&(n.stroke=e.stroke),e.strokeDash&&(n.strokeDash=e.strokeDash),e.strokeWidth&&(n.strokeWidth=e.strokeWidth)),n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"links",value:function(e){return arguments.length?(this._links=e,this):this._links}},{key:"_doFill",value:function(e){this.stroke&&(e.fillStyle=this.stroke),e.fill()}},{key:"_doFillHighlight",value:function(e){this._doFill(e)}},{key:"_doFillLowlight",value:function(e){e.fillStyle=this.lowlightStroke,e.fill()}},{key:"_doStroke",value:function(e){this.strokeDash&&e.setLineDash(this.strokeDash),this.strokeWidth&&(e.lineWidth=this.strokeWidth),e.strokeStyle=this.stroke,e.stroke()}},{key:"_doStrokeHighlight",value:function(e){this.strokeDash&&e.setLineDash(this.strokeDash),this.strokeWidth&&(e.lineWidth=2*this.strokeWidth),e.strokeStyle=this.stroke,e.stroke()}},{key:"_doStrokeLowlight",value:function(e){this.strokeDash&&e.setLineDash(this.strokeDash),this.strokeWidth&&(e.lineWidth=this.strokeWidth),e.strokeStyle=this.lowlightStroke,e.lineWidth=this.lowlightWidth,e.stroke()}}]),t}(M),G=Math.PI/6,q=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e)))._arrowheadSize=10,n._highlight=null,n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"render",value:function(e,t,n){var a=this;e.save();var i=Object(k.partition)(this._links,(function(e){return e===a._highlight})),r=Object(w.a)(i,2),l=r[0],o=r[1];if(l.length){e.beginPath();var s=this._drawLinks(l,e,t,n),c=Object(w.a)(s,2),u=c[0],h=c[1];this._doStrokeHighlight(e),e.beginPath(),this._drawArrows(u,h,e),this._doStrokeHighlight(e),this._doFillHighlight(e),e.beginPath();var d=this._drawLinks(o,e,t,n),f=Object(w.a)(d,2),p=f[0],g=f[1];this._doStroke(e),e.beginPath(),this._drawArrows(p,g,e),this._doStroke(e),this._doFill(e)}else{e.beginPath();var m=this._drawLinks(o,e,t,n),v=Object(w.a)(m,2),b=v[0],y=v[1];null===this._highlight?(this._doStroke(e),e.beginPath(),this._drawArrows(b,y,e),this._doStroke(e),this._doFill(e)):(this._doStrokeLowlight(e),e.beginPath(),this._drawArrows(b,y,e),this._doStrokeLowlight(e),this._doFillLowlight(e))}e.restore()}},{key:"highlight",value:function(e){this._highlight=e}},{key:"_arrow",value:function(e,t,n,a,i){var r=this._arrowheadSize;a.push(e-r*Math.sin(n-G)),i.push(t-r*Math.cos(n-G)),a.push(e),i.push(t),a.push(e-r*Math.sin(n+G)),i.push(t-r*Math.cos(n+G))}},{key:"_drawArrows",value:function(e,t,n){for(var a=e.length,i=0;i<a;i+=3)n.moveTo(e[i],t[i]),n.lineTo(e[i+1],t[i+1]),n.lineTo(e[i+2],t[i+2]),n.closePath()}},{key:"_drawLinks",value:function(e,t,n,a){var i=this,r=[],l=[];return e.forEach((function(e){var o=e.path;if(o){o.apply(t,n,a);var s=o.angleAlong(1,n,a)+Math.PI,c=o.pointAlong(1,n,a);i._arrow(c.x,c.y,s,r,l)}})),[r,l]}}]),t}(B),Z=function e(){Object(c.a)(this,e)};function U(e,t,n){return{x:t(e.x)+(e.dx?e.dx:0),y:n(e.y)+(e.dy?e.dy:0)}}var Q=function(e){function t(e,n,a,i){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(h.a)(t).call(this)))._start=e,r._c1=n,r._c2=a,r._end=i,r}return Object(d.a)(t,e),Object(f.a)(t,[{key:"angleAlong",value:function(e,t,n){var a=U(this._start,t,n),i=U(this._c1,t,n),r=U(this._c2,t,n),l=U(this._end,t,n),o=1-e,s=o*o*(i.x-a.x)+2*e*o*(r.x-i.x)+e*e*(l.x-r.x),c=o*o*(i.y-a.y)+2*e*o*(r.y-i.y)+e*e*(l.y-r.y);return Math.atan2(s,c)-Math.PI}},{key:"apply",value:function(e,t,n){var a=U(this._start,t,n),i=U(this._c1,t,n),r=U(this._c2,t,n),l=U(this._end,t,n);e.moveTo(a.x,a.y),e.bezierCurveTo(i.x,i.y,r.x,r.y,l.x,l.y)}},{key:"pointAlong",value:function(e,t,n){var a=U(this._start,t,n),i=U(this._c1,t,n),r=U(this._c2,t,n),l=U(this._end,t,n),o=1-e;return{x:o*o*o*a.x+3*e*o*o*i.x+3*e*e*o*r.x+e*e*e*l.x,y:o*o*o*a.y+3*e*o*o*i.y+3*e*e*o*r.y+e*e*e*l.y}}},{key:"points",value:function(){return[this._start,this._c1,this._c2,this._end]}}]),t}(Z),X=function(e){function t(e,n){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(h.a)(t).call(this)))._start=e,a._end=n,a}return Object(d.a)(t,e),Object(f.a)(t,[{key:"angleAlong",value:function(e,t,n){var a=U(this._start,t,n),i=U(this._end,t,n);return Math.atan2(a.x-i.x,a.y-i.y)}},{key:"apply",value:function(e,t,n){var a=U(this._start,t,n),i=U(this._end,t,n);e.moveTo(a.x,a.y),e.lineTo(i.x,i.y)}},{key:"pointAlong",value:function(e,t,n){var a=U(this._start,t,n),i=U(this._end,t,n);return{x:a.x+e*(i.x-a.x),y:a.y+e*(i.y-a.y)}}},{key:"points",value:function(){return[this._start,this._end]}}]),t}(Z),Y=function(e){function t(e,n,a){var i;return Object(c.a)(this,t),(i=Object(u.a)(this,Object(h.a)(t).call(this)))._start=e,i._control=n,i._end=a,i}return Object(d.a)(t,e),Object(f.a)(t,[{key:"angleAlong",value:function(e,t,n){var a=U(this._start,t,n),i=U(this._control,t,n),r=U(this._end,t,n),l=1-e,o=2*l*(i.x-a.x)+2*e*(r.x-i.x),s=2*l*(i.y-a.y)+2*e*(r.y-i.y);return Math.atan2(o,s)-Math.PI}},{key:"apply",value:function(e,t,n){var a=U(this._start,t,n),i=U(this._control,t,n),r=U(this._end,t,n);e.moveTo(a.x,a.y),e.quadraticCurveTo(i.x,i.y,r.x,r.y)}},{key:"pointAlong",value:function(e,t,n){var a=U(this._start,t,n),i=U(this._control,t,n),r=U(this._end,t,n),l=1-e;return{x:l*l*a.x+2*l*e*i.x+e*e*r.x,y:l*l*a.y+2*l*e*i.y+e*e*r.y}}},{key:"points",value:function(){return[this._start,this._control,this._end]}}]),t}(Z);var J=n(18),$=function(){function e(){Object(c.a)(this,e),this._all=new Map,this._map=new Map,this._ind=new Map}return Object(f.a)(e,[{key:"add",value:function(e,t,n){this._addDirectional(e,t,n),this._addNonDirectional(e,t,n)}},{key:"allBetween",value:function(e,t){return this._getNonDirectional(e,t)}},{key:"between",value:function(e,t){var n=this._map.get(e);return n&&n.get(t)||[]}},{key:"forEach",value:function(e){var t=this;this._map.forEach((function(n,a){n.forEach((function(n,i){var r=t._getNonDirectional(a,i);n.forEach((function(t){return e(t,a,i,r)}))}))}))}},{key:"indexOf",value:function(e){return this._ind.get(e)}},{key:"_addDirectional",value:function(e,t,n){this._map.has(e)||this._map.set(e,new Map);var a=this._map.get(e);a.has(t)||a.set(t,[]),a.get(t).push(n)}},{key:"_addNonDirectional",value:function(e,t,n){if(this._all.has(e)){var a=this._all.get(e);a.has(t)||a.set(t,[]);var i=a.get(t).push(n);this._ind.set(n,i-1)}else if(this._all.has(t)){var r=this._all.get(t);r.has(e)||r.set(e,[]);var l=r.get(e).push(n);this._ind.set(n,1-l)}else this._all.set(e,new Map([[t,[n]]])),this._ind.set(n,0)}},{key:"_getNonDirectional",value:function(e,t){if(this._all.has(e)){var n=this._all.get(e);if(n.has(t))return n.get(t)}if(this._all.has(t)){var a=this._all.get(t);if(a.has(e))return a.get(e)}return[]}}]),e}();function K(e,t,n){var a=Math.atan2(e.y-t.y,t.x-e.x),i=n.intersect(a);e.dx=i.x,e.dy=i.y}var ee=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this)))._collapse=!0,e._factor=.25,e}return Object(d.a)(t,e),Object(f.a)(t,[{key:"calculateLink",value:function(e,t,n,a){var i={x:t.x,y:t.y},r={x:n.x,y:n.y},l=this._nodeShapeMap.get(t),o=this._nodeShapeMap.get(n);if(t===n&&l){var s=l.selfLoopPoints(t);e.path=new Q(s[0],s[1],s[2],s[3])}else{var c=this._bundleMap.indexOf(e),u=void 0!==c&&a.length>1?this._bundlePoints(i,r,c,a.length):[i,r];2===u.length&&(e.path=new X(u[0],u[1])),3===u.length&&(e.path=new Y(u[0],u[1],u[2])),this._calcalateShapeOffsets(e,l,o)}}},{key:"getFactor",value:function(){return this._factor}},{key:"setFactor",value:function(e){this._factor=e}},{key:"_bundlePoints",value:function(e,t,n,a){if(this._factor<.005)return[e,t];var i=this._factor*function(e,t){var n=t.x-e.x,a=t.y-e.y;return Math.sqrt(n*n+a*a)}(e,t),r=Math.sign(n)||1,l=Math.atan2(t.y-e.y,t.x-e.x)+r*Math.PI/2,o=(e.x+t.x)/2,s=(e.y+t.y)/2,c=o+i/2*Math.cos(l),u=s+i/2*Math.sin(l);l-=Math.PI;var h=Math.abs(n)/(a-1);return[e,{x:c+h*i*Math.cos(l),y:u+h*i*Math.sin(l)},t]}}]),t}(function(){function e(){Object(c.a)(this,e),this._bundleMap=new $,this._edgeLinkMap=new Map,this._groupLinkMap=new Map,this._linkEdgeMap=new Map,this._nameNodeMap=new Map,this._nodeEdgeMap=new Map,this._ungroupedLinks=[],this._collapse=!0,this._nodeShapeMap=new Map}return Object(f.a)(e,[{key:"getLinks",value:function(e){var t=this;return e?e.map((function(e){return t._groupLinkMap.get(e)})).filter(I.isDefined).reduce((function(e,t){return e.concat(t)}),[]):Array.from(this._linkEdgeMap.keys())}},{key:"getLinkMap",value:function(){return this._linkEdgeMap}},{key:"getUngroupedLinks",value:function(){return this._ungroupedLinks}},{key:"setData",value:function(e,t,n){var a=this;this._bundleMap=new $,this._edgeLinkMap=new Map,this._groupLinkMap=new Map,this._linkEdgeMap=new Map,this._nameNodeMap=new Map(e.map((function(e){return[e.id,e]}))),this._nodeEdgeMap=function(e,t){var n=new Map;return t.forEach((function(t){var a=e.get(t.source),i=e.get(t.target);a&&i&&(n.has(a)||n.set(a,[]),n.has(i)||n.set(i,[]),n.get(a).push(t),n.get(i).push(t))})),n}(this._nameNodeMap,t),this._ungroupedLinks=[],this._nodeShapeMap=new Map,n.forEach((function(e){return e.nodes().forEach((function(t){return a._nodeShapeMap.set(t,e)}))})),(this._collapse?function(e){var t=new Map,n=[];e.forEach((function(e){e.group?(t.has(e.group)||t.set(e.group,[]),t.get(e.group).push(e)):n.push(e)}));var a=[n].concat(Object(J.a)(Array.from(t.values()))),i=[];return a.forEach((function(e){var t=new Map;e.forEach((function(e){var n=e.source+e.target;t.has(n)||t.set(n,[]),t.get(n).push(e)})),i.push.apply(i,Object(J.a)(Array.from(t.values())))})),i}(t):t.map((function(e){return[e]}))).forEach((function(e){if(e.length){var t=e[0].group,n=e[0].source,i=e[0].target,r=a._nameNodeMap.get(n),l=a._nameNodeMap.get(i);if(r&&l){var o={path:void 0,labels:[]};a._linkEdgeMap.set(o,e),e.forEach((function(e){a._edgeLinkMap.set(e,o)})),a._bundleMap.add(r,l,o),t?(a._groupLinkMap.has(t)||a._groupLinkMap.set(t,[]),a._groupLinkMap.get(t).push(o)):a._ungroupedLinks.push(o)}}})),this.updateLinks()}},{key:"updateLinks",value:function(){this._bundleMap.forEach(this.calculateLink.bind(this))}},{key:"updateLinksConnectedTo",value:function(e){var t=this,n=this._nodeEdgeMap.get(e);if(n){var a=new Set;return n.forEach((function(e){var n=t._edgeLinkMap.get(e);if(n&&!a.has(n)){var i=t._nameNodeMap.get(e.source),r=t._nameNodeMap.get(e.target);if(i&&r){var l=t._bundleMap.allBetween(i,r);t.calculateLink(n,i,r,l)}a.add(n)}})),Array.from(a)}return[]}},{key:"_calcalateShapeOffsets",value:function(e,t,n){var a=e.path?e.path.points():[];if(!(a.length<2)){if(t)K(a[0],a[1],t);if(n)K(a[a.length-1],a[a.length-2],n)}}}]),e}());function te(e,t){S(e,t,["font","color"])}function ne(e){var t={};return te(t,e),t}function ae(e,t){S(e,t,["stroke","strokeDash","strokeWidth"])}function ie(e){var t={};return ae(t,e),t}function re(e){var t=new Map;return function e(n,a){var i=ne(n.label||{});a&&te(i,a),n.children&&n.children.forEach((function(t){e(t,i)})),t.set(i,function(e){return function(e){return void 0!==e.groups}(e)?e.groups:function(e){return void 0!==e.nodes}(e)?e.nodes:[]}(n))}(e),t}function le(e){var t=new Map;return function e(n,a){var i=x(n.shape||{});a&&(!function(e,t){if(j(e)&&j(t))S(e,t,["type","radius"]);else if(O(e)&&O(t))S(e,t,["type","width","height"]);else if(!e.type){if(j(t))return void S(e,t,["type","radius"]);if(O(t))S(e,t,["type","width","height"])}}(i,a),E(i,a)),n.children&&n.children.forEach((function(t){e(t,i)})),t.set(i,n.nodes)}(e),t}var oe=function(){function e(){Object(c.a)(this,e),this._labeller=new z,this._router=new ee,this._nodes=[],this._edges=[],this._shapes=[],this._styles=[],this._links=[],this._labels=[]}return Object(f.a)(e,[{key:"getEdges",value:function(){return this._edges}},{key:"getLabelPlacement",value:function(){return this._labeller.getPlacement()}},{key:"getRouter",value:function(){return this._router}},{key:"labelRenderers",value:function(){return this._labels}},{key:"linkRenderers",value:function(){return this._links}},{key:"setEdges",value:function(e){return this._edges=e,this}},{key:"setLabelPlacement",value:function(e){return this._labeller.setPlacement(e),this}},{key:"setNodes",value:function(e){return this._nodes=e,this}},{key:"setShapes",value:function(e){return this._shapes=e,this}},{key:"setStyles",value:function(e){return this._styles=e,this}},{key:"update",value:function(){this._router.setData(this._nodes,this._edges,this._shapes),this._recalculateRenderers()}},{key:"updateEdgesConnectedTo",value:function(e){this._router.updateLinksConnectedTo(e)}},{key:"_calculateLabelRenderers",value:function(){var e=this;this._labeller.setLinkMap(this._router.getLinkMap()),this._labeller.update();var t=[],n=new Set(this._router.getLinks());if(this._styles.forEach((function(a){re(a).forEach((function(a,i){var r=new H(i),l=e._router.getLinks(a);l.forEach((function(e){return n.delete(e)})),r.links(l),t.push(r)}))})),n.size>0){var a=new H,i=Array.from(n.values());a.links(i),t.push(a)}return t}},{key:"_calculateLinkRenderers",value:function(){var e=this,t=[],n=new Set;this._edges.forEach((function(e){e.group&&n.add(e.group)})),this._styles.forEach((function(a){(function(e){var t=new Map;return function e(n,a){var i=ie(n.link||{});a&&ae(i,a),n.children&&n.children.forEach((function(t){e(t,i)})),t.set(i,n.groups)}(e),t})(a).forEach((function(a,i){var r=new q(i),l=e._router.getLinks(a);r.links(l),t.push(r),a.forEach((function(e){return n.delete(e)}))}))}));var a=new q,i=this._router.getLinks(Array.from(n)).concat(this._router.getUngroupedLinks());return a.links(i),t.push(a),t}},{key:"_recalculateRenderers",value:function(){this._links=this._calculateLinkRenderers(),this._labels=this._calculateLabelRenderers()}}]),e}(),se=n(904),ce=function(e){function t(e,n,a){var i;return Object(c.a)(this,t),(i=Object(u.a)(this,Object(h.a)(t).call(this)))._canvas=e,i._delaunay=null,i._links=[],i._transform=A.h,i._x=n,i._y=a,i._lastLink=null,i._maxDist=25,i._numsections=25,A.f(i._canvas).on("mousemove",i._onHover.bind(Object(F.a)(i))),i}return Object(d.a)(t,e),Object(f.a)(t,[{key:"render",value:function(e){this._delaunay&&(e.save(),this._delaunay.render(e),e.strokeStyle="red",e.lineWidth=2,e.stroke(),e.restore())}},{key:"setData",value:function(e){var t=[];this._links=[];var n=!0,a=!1,i=void 0;try{for(var r,l=e.keys()[Symbol.iterator]();!(n=(r=l.next()).done);n=!0){var o=r.value,s=o.path;if(s)for(var c=1/this._numsections,u=0;u<=this._numsections;++u)t.push(s.pointAlong(c*u,this._x,this._y)),this._links.push(o)}}catch(h){a=!0,i=h}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return this._delaunay=se.a.from(t,(function(e){return e.x}),(function(e){return e.y})),this}},{key:"setTransform",value:function(e){return this._transform=e,this}},{key:"_distance",value:function(e,t,n){for(var a,i,r,l,o=1/0,s=0;s<=this._numsections;++s){var c=n.pointAlong(s/this._numsections,this._x,this._y),u=(a=e,i=t,r=c.x,l=c.y,Math.pow(r-a,2)+Math.pow(l-i,2));u<o&&(o=u)}return Math.sqrt(o)}},{key:"_onHover",value:function(){var e=A.c(this._canvas),t=this._transform.invertX(e[0]),n=this._transform.invertY(e[1]);if(this._delaunay){var a=this._delaunay.find(t,n);if(a<this._links.length){var i=this._links[a],r=i.path,l=this._distance(t,n,r);this._setHover(i,l)}}}},{key:"_setHover",value:function(e,t){t<this._maxDist?e!==this._lastLink&&(this._lastLink=e,this.dispatchEvent({type:"hover",link:e})):null!==this._lastLink&&(this._lastLink=null,this.dispatchEvent({type:"hover",link:null}))}}]),t}(V);var ue=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this)))._nodes=[],n.color=t.defaultColor,n.font=t.defaultFont,e&&(e.color&&(n.color=e.color),e.font&&(n.font=e.font)),n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"nodes",value:function(e){return arguments.length?(this._nodes=e,this):this._nodes}},{key:"render",value:function(e,t,n){var a=this;this._nodes.length&&(e.save(),e.beginPath(),this.color&&(e.fillStyle=this.color),e.font=this.font,e.textAlign="center",e.textBaseline="middle",this._nodes.forEach((function(i){if(i.labels){var r=a.font.match(/(\d*)px/),l=r&&r.length>1?parseInt(r[1]):12,o=[i.id].concat(Object(J.a)(i.labels)),s=Math.floor(o.length*l/2-l/2)-1;o.forEach((function(a,r){e.fillText(a,t(i.x)+(i.dx?i.dx:0),n(i.y)+(i.dy?i.dy:0)-s+r*l)}))}else e.fillText(i.id,t(i.x)+(i.dx?i.dx:0),n(i.y)+(i.dy?i.dy:0))})),e.restore())}}]),t}(M);ue.defaultColor="#333333",ue.defaultFont="14px sans-serif";var he=2*Math.PI,de=Math.PI/6,fe=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e)))._radius=t.defaultRadius,e&&j(e)&&e.radius&&(n._radius=e.radius),n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"bounds",value:function(e,t){var n=this,a=new C;return this._nodes.forEach((function(i){var r=e(i.x),l=t(i.y);a.expand(r+n._radius,l+n._radius),a.expand(r-n._radius,l-n._radius)})),a}},{key:"containsPoint",value:function(e,t,n,a){a=a||1;var i=t-e.x,r=n-e.y,l=i*i+r*r,o=this._radius/a;return l<o*o}},{key:"intersect",value:function(e){return{x:this._radius*Math.cos(e),y:this._radius*Math.sin(e)}}},{key:"radius",value:function(e){return arguments.length?(this._radius=+e,this):this._radius}},{key:"render",value:function(e,t,n){var a=this;this._nodes.length&&(e.save(),e.beginPath(),this._nodes.forEach((function(i){var r=t(i.x),l=n(i.y);e.moveTo(r+a._radius,l),e.arc(r,l,a._radius,0,he)})),this._doStrokeAndFill(e),e.restore())}},{key:"selfLoopPoints",value:function(e){var t=e.x,n=e.y;return[{x:t,y:n,dx:this._radius*Math.cos(-de),dy:this._radius*Math.sin(-de)},{x:t,y:n,dx:3*this._radius*Math.cos(-de),dy:3*this._radius*Math.sin(-de)},{x:t,y:n,dx:3*this._radius*Math.cos(de),dy:3*this._radius*Math.sin(de)},{x:t,y:n,dx:this._radius*Math.cos(de),dy:this._radius*Math.sin(de)}]}}]),t}(T);fe.defaultRadius=60;var pe=function(){function e(){Object(c.a)(this,e),this._nodes=new Map,this._labels=[],this._shapes=[],this._styles=[]}return Object(f.a)(e,[{key:"labelRenderers",value:function(){return this._labels}},{key:"nodes",value:function(e){var t=this;return e?(this._nodes=new Map,e.map((function(e){return"string"===typeof e?{id:e,x:0,y:0}:e})).forEach((function(e){if(t._nodes.has(e.id))throw Error("Duplicate node ".concat(e.id));t._nodes.set(e.id,e)})),this):Array.from(this._nodes.values())}},{key:"shapeRenderers",value:function(){return this._shapes}},{key:"setStyles",value:function(e){return this._styles=e,this}},{key:"update",value:function(){this._shapes=this._calculateShapeRenderers(),this._labels=this._calculateLabelRenderers()}},{key:"_calculateLabelRenderers",value:function(){var e=[],t=new Map(this._nodes);if(this._styles.forEach((function(n){re(n).forEach((function(n,a){var i=new ue(a),r=ge(n,t);i.nodes(r),e.push(i)}))})),t.size>0){var n=new ue,a=Array.from(t.values());n.nodes(a),e.push(n)}return e}},{key:"_calculateShapeRenderers",value:function(){var e=[],t=new Map(this._nodes);if(this._styles.forEach((function(n){le(n).forEach((function(n,a){var i;i=j(a)?new fe(a):O(a)?new R(a):new fe(a);var r=ge(n,t);i.nodes(r),e.push(i)}))})),t.size>0){var n=new fe,a=Array.from(t.values());n.nodes(a),e.push(n)}return e}}]),e}();function ge(e,t){var n=[];return e.forEach((function(e){t.has(e)&&(n.push(t.get(e)),t.delete(e))})),n}var me=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this)))._axesVisible=!0,e._gridVisible=!0,e._axisColor="#bbbbbb",e._gridColor="#dddddd",e._ticks=10,e._ticksize=8,e._labelpadding=4,e._gridPattern=[5,5],e}return Object(d.a)(t,e),Object(f.a)(t,[{key:"axesVisible",value:function(e){return this._axesVisible=e,this}},{key:"gridVisible",value:function(e){return this._gridVisible=e,this}},{key:"render",value:function(e,t,n){var a=this,i=ve(t(0)),r=ve(n(0)),l=t.range().map(ve),o=n.range().map(ve),s=Math.abs(l[1]/o[1]),c=this._ticksize/2,u=t.ticks(this._ticks*s),h=n.ticks(this._ticks);e.save(),e.beginPath(),this._gridVisible&&(h.forEach((function(t){if(0!==t||!a._axesVisible){var i=ve(n(t));e.moveTo(l[0],i),e.lineTo(l[1],i)}})),e.setLineDash(this._gridPattern),e.lineDashOffset=-i,e.strokeStyle=this._gridColor,e.stroke(),e.beginPath(),u.forEach((function(n){if(0!==n||!a._axesVisible){var i=ve(t(n));e.moveTo(i,o[0]),e.lineTo(i,o[1])}})),e.lineDashOffset=-r,e.stroke()),this._axesVisible&&(e.beginPath(),e.moveTo(l[0],r),e.lineTo(l[1],r),u.forEach((function(n){if(0!==n){var a=ve(t(n));e.moveTo(a,r-c),e.lineTo(a,r+c)}})),e.moveTo(i,o[0]),e.lineTo(i,o[1]),h.forEach((function(t){if(0!==t){var a=ve(n(t));e.moveTo(i-c,a),e.lineTo(i+c,a)}})),e.setLineDash([]),e.strokeStyle=this._axisColor,e.stroke(),e.font="10px sans-serif",e.textAlign="center",e.textBaseline="top",e.fillStyle=this._axisColor,u.forEach((function(n){if(0!==n){var i=ve(t(n));e.fillText(n.toString(),i,r+c+a._labelpadding)}})),e.textAlign="left",e.textBaseline="middle",h.forEach((function(t){if(0!==t){var r=ve(n(t));e.fillText(t.toString(),i+c+a._labelpadding,r)}}))),e.restore()}}]),t}(M);function ve(e){return Math.round(e)+.5}var be=function(){function e(t){Object(c.a)(this,e),this._canvas=t||null,this._context=null,this._axes=new me,this._linkLabelRenderers=[],this._linkRenderers=[],this._nodeLabelRenderers=[],this._nodeRenderers=[],this._width=0,this._height=0,this._x=A.e(),this._y=A.e(),this._transform=A.h,this._zoom=A.g(),this._nodeManager=new pe,this._edgeManager=new oe,this._dragManager=null,this._hoverManager=null,this._axesVisible=!0,this._initializeCanvas()}return Object(f.a)(e,[{key:"axesVisible",value:function(e){return this._axes.axesVisible(e),this}},{key:"boundingBox",value:function(){var e=this._transform.invertY(0),t=this._transform.invertX(this._width),n=this._transform.invertY(this._height),a=this._transform.invertX(0);return[this._y.invert(e),this._x.invert(t),this._y.invert(n),this._x.invert(a)]}},{key:"bundleFactor",value:function(e){var t=this._edgeManager.getRouter();return arguments.length?(t instanceof ee&&t.setFactor(e),this):t instanceof ee?t.getFactor():void 0}},{key:"canvas",value:function(e){return this._canvas=e,this._initializeCanvas(),this}},{key:"edgeLabelPlacement",value:function(e){return arguments.length?(this._edgeManager.setLabelPlacement(e),this):this._edgeManager.getLabelPlacement()}},{key:"edges",value:function(e){return e?(this._edgeManager.setEdges(e),this):this._edgeManager.getEdges()}},{key:"edgeStyles",value:function(e){return this._edgeManager.setStyles(e),this}},{key:"gridVisible",value:function(e){return this._axes.gridVisible(e),this}},{key:"resize",value:function(){if(this._canvas){var e=getComputedStyle(this._canvas),t=parseInt(e.getPropertyValue("width")),n=parseInt(e.getPropertyValue("height"));this._setDimensions(t,n),this._updateHoverManager(),this._render()}}},{key:"nodes",value:function(e){if(!e)return this._nodeManager.nodes();this._nodeManager.nodes(e);var t=this._nodeManager.nodes();return this._edgeManager.setNodes(t),this}},{key:"nodeStyles",value:function(e){return this._nodeManager.setStyles(e),this}},{key:"update",value:function(){this._nodeManager.update(),this._nodeRenderers=this._nodeManager.shapeRenderers(),this._edgeManager.setShapes(this._nodeRenderers),this._edgeManager.update(),this._updateDragManager(),this._updateHoverManager(),this._linkRenderers=this._edgeManager.linkRenderers(),this._linkLabelRenderers=this._edgeManager.labelRenderers(),this._nodeLabelRenderers=this._nodeManager.labelRenderers(),this._render()}},{key:"zoomToFit",value:function(){var e=this;if(this._canvas&&this._nodeRenderers.length){var t=this._width,n=this._height,a=new C;this._nodeRenderers.forEach((function(t){a.expand(t.bounds(e._x,e._y))}));var i=a.bounds(),r=Object(w.a)(i,2),l=Object(w.a)(r[0],2),o=l[0],s=l[1],c=Object(w.a)(r[1],2),u=c[0],h=c[1];A.f(this._canvas).transition().duration(750).call(this._zoom.transform,A.h.translate(this._x(0),this._y(0)).scale(Math.min(8,.9/Math.max((u-o)/t,(h-s)/n))).translate(-(o+u)/2,-(s+h)/2))}}},{key:"zoomToHome",value:function(){this._canvas&&A.f(this._canvas).transition().duration(750).call(this._zoom.transform,A.h)}},{key:"_initializeCanvas",value:function(){var e=this,t=this._canvas;if(t){var n=t.getContext("2d");if(null===n)throw Error("Unable to initialize canvas");this._context=n,this._dragManager=new P(t,this._x,this._y),this._hoverManager=new ce(t,this._x,this._y),this._zoom.scaleExtent([.1,500]).on("zoom",this._zoomed.bind(this)),A.f(t).call(this._zoom).call(this._zoom.transform,this._transform),this._dragManager.addEventListener("drag",(function(t){e._edgeManager.updateEdgesConnectedTo(t.node),e._render()})).addEventListener("end",(function(){e._hoverManager&&(e._updateHoverManager(),e._render())})),this._hoverManager.addEventListener("hover",(function(t){e._linkRenderers.forEach((function(e){return e.highlight(t.link)})),e._linkLabelRenderers.forEach((function(e){return e.highlight(t.link)})),e._render()})),this.update(),this.resize()}else this._context=null,this._dragManager=null}},{key:"_render",value:function(){var e=this,t=this._context;t&&window.requestAnimationFrame((function(){var n=e._transform.rescaleX(e._x),a=e._transform.rescaleY(e._y);t.clearRect(0,0,e._width,e._height),e._axesVisible&&e._axes.render(t,n,a),e._linkRenderers.forEach((function(e){e.render(t,n,a)})),e._linkLabelRenderers.forEach((function(e){e.render(t,n,a)})),e._nodeRenderers.forEach((function(e){e.render(t,n,a)})),e._nodeLabelRenderers.forEach((function(e){e.render(t,n,a)}))}))}},{key:"_setDimensions",value:function(e,t){this._canvas&&(this._canvas.setAttribute("width",e.toString()),this._canvas.setAttribute("height",t.toString()),this._width=e,this._height=t,this._x.domain([-e/2,e/2]).range([0,e]),this._y.domain([t/2,-t/2]).range([0,t]))}},{key:"_setTransform",value:function(e){this._transform=e,this._dragManager&&this._dragManager.setTransform(e),this._hoverManager&&this._hoverManager.setTransform(e)}},{key:"_updateDragManager",value:function(){this._dragManager&&this._dragManager.setShapes(this._nodeRenderers)}},{key:"_updateHoverManager",value:function(){this._hoverManager&&this._hoverManager.setData(this._edgeManager.getRouter().getLinkMap())}},{key:"_zoomed",value:function(){this._setTransform(A.b.transform),this._render()}}]),e}(),ye=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(f.a)(t,[{key:"apply",value:function(e){for(var t=e.boundingBox(),n=(t[1]+t[3])/2,a=(t[0]+t[2])/2,i=.8*Math.abs(t[1]-t[3]),r=.8*Math.abs(t[0]-t[2]),l=e.nodes(),o=i/r,s=0,c=0;s*c<l.length;)c/s<o?++c:++s;var u=a+r/2,h=n-i/2,d=i/c,f=r/s,p=0,g=0;l.forEach((function(e){e.x=h+g*d,e.y=u-p*f,g++===c&&(g=0,p++)}))}}]),t}(b),_e=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this)))._groups=[],e}return Object(d.a)(t,e),Object(f.a)(t,[{key:"apply",value:function(e){var t=e.boundingBox(),n=(t[1]+t[3])/2,a=(t[0]+t[2])/2,i=.8*Math.abs(t[1]-t[3]),r=.8*Math.abs(t[0]-t[2]),l=[],o=new Map(e.nodes().map((function(e){return[e.id,e]})));this._groups.forEach((function(e){var t=e.map((function(e){var t=o.get(e);return o.delete(e),t})).filter(I.isDefined);t.length&&l.push(t)})),l.push(Array.from(o.values()));var s=l.length||1,c=a+r/2,u=n-i/2,h=i/Math.max.apply(Math,Object(J.a)(l.map((function(e){return e.length})))),d=r/(s-1||1);l.forEach((function(e,t){var n=c-t*d;e.forEach((function(e,t){e.x=u+h*t,e.y=n}))}))}},{key:"groups",value:function(e){return this._groups=e,this}}]),t}(b),ke=n(29),Se=n(15),Ee=Object(ke.a)({name:"sterling",initialState:{instance:null,mainView:"graph",tableView:null,graphView:null,sourceView:"files",welcomeDescription:"Use Alloy to generate an instance.",welcomeTitle:"Welcome to Sterling"},reducers:{setGraphView:function(e,t){e.graphView=t.payload===e.graphView?null:t.payload},setInstance:function(e,t){e.instance=t.payload},setMainView:function(e,t){e.mainView=t.payload},setSourceView:function(e,t){e.sourceView=t.payload===e.sourceView?null:t.payload},setTableView:function(e,t){e.tableView=t.payload===e.tableView?null:t.payload}}}),xe=Ee.actions,je=xe.setGraphView,Oe=xe.setInstance,we=xe.setMainView,Ce=xe.setSourceView,Me=xe.setTableView,Te=Ee.reducer,Le={asAttribute:Object(Se.b)(),atoms:Object(Se.b)(),collapseProjections:!1,projections:Object(Se.b)(),unprojected:Object(Se.a)()},De=Object(ke.a)({name:"graphdata",initialState:Le,reducers:{addProjection:function(e,t){var n=t.payload,a=e.atoms.get(n);if(a&&a.length){var i=a[0];e.projections=e.projections.set(n,i);var r=e.unprojected.indexOf(n);-1!==r&&(e.unprojected=e.unprojected.delete(r))}},nextAtom:function(e,t){var n=t.payload,a=e.projections.get(n),i=e.atoms.get(n);if(a&&i){var r=i.indexOf(a),l=r+1;-1!==r&&l<i.length&&(e.projections=e.projections.set(n,i[l]))}},previousAtom:function(e,t){var n=t.payload,a=e.projections.get(n),i=e.atoms.get(n);if(a&&i){var r=i.indexOf(a),l=r-1;-1!==r&&l>=0&&(e.projections=e.projections.set(n,i[l]))}},removeProjection:function(e,t){var n=t.payload;e.projections=e.projections.delete(n),e.unprojected=e.unprojected.push(n).sort(Re)},setProjection:function(e,t){var n=t.payload,a=n.sig,i=n.atom;e.projections.has(a)&&e.projections.get(a)!==i&&(e.projections=e.projections.set(a,i))},toggleAsAttribute:function(e,t){var n=t.payload;if(n){var a=e.asAttribute.get(n);e.asAttribute=e.asAttribute.set(n,!a)}},toggleCollapseProjections:function(e){e.collapseProjections=!e.collapseProjections}},extraReducers:function(e){return e.addCase(Oe,(function(e,t){var n=t.payload;if(n){var a=n.signatures().find((function(e){return"univ"===e.id()}));if(a){var i=a.subTypes(),r=n.fields(),l=n.skolems().filter((function(e){return e.arity()>1})),o=[].concat(Object(J.a)(r),Object(J.a)(l));e.projections=Object(Se.b)().withMutations((function(t){i.forEach((function(n){var a=e.projections.get(n.id());a&&n.findAtom(a)&&t.set(n.id(),a)}))})),e.asAttribute=Object(Se.b)(o.map((function(t){var n=t.id();return e.asAttribute.has(n)?[n,e.asAttribute.get(n)]:[n,!1]}))),e.unprojected=Object(Se.a)().withMutations((function(t){i.forEach((function(n){var a=n.id();n.atoms(!0).length&&!e.projections.has(a)&&t.push(a)}))})).sort(Re),e.atoms=Object(Se.b)(i.map((function(e){return[e.id(),e.atoms(!0).map((function(e){return e.name()}))]})))}else e.asAttribute=Object(Se.b)(),e.atoms=Object(Se.b)(),e.projections=Object(Se.b)(),e.unprojected=Object(Se.a)()}else e.atoms=Object(Se.b)(),e.projections=Object(Se.b)(),e.unprojected=Object(Se.a)()}))}});function Re(e,t){return e.localeCompare(t)}var Ne=De.actions,Ae=Ne.addProjection,Fe=Ne.nextAtom,Ve=Ne.previousAtom,Pe=Ne.removeProjection,Ie=Ne.setProjection,ze=Ne.toggleAsAttribute,We=Ne.toggleCollapseProjections,He=De.reducer,Be=n(907),Ge=n(894),qe=n(895),Ze=n(896),Ue=n(897),Qe=n(898),Xe={preventOverflow:{enabled:!1},hide:{enabled:!1}},Ye=[["Tableu",function(e){var t=e.length/6|0,n=new Array(t),a=0;for(;a<t;)n[a]="#"+e.slice(6*a,6*++a);return n}("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab")],["Turbo",[0,1,2,4,5,6,7].map((function(e){return t=e/8,t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")";var t})).map((function(e){return Be.b(e).hex()}))],["Categorical",Ge.a.slice()],["Accent",qe.a.slice()],["Dark",Ze.a.slice()],["Pastel",Ue.a.slice()],["Paired",Qe.a.slice()]],Je=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffc107","#ff9800","#ff5722","#795548","#607d8b","#333333","#777777","#bbbbbb","#ffffff"];function $e(e){if(e){var t=Be.a(e);return t?t.hex():void 0}}function Ke(e){if(!e.length)return"";var t=100/e.length,n=e.map((function(e,n){return"".concat(e," ").concat(n*t,"% ").concat((n+1)*t,"%")}));return"linear-gradient(to right, ".concat(n.join(","),")")}function et(e){if(e){var t=Be.a(e);if(t){var n=t.rgb();return(299*n.r+587*n.g+114*n.b)/1e3>125?"#000000":"#ffffff"}}}var tt=n(902),nt=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,n="string"===typeof e.signature?e.signature:e.nameFunction?e.nameFunction(e.signature):e.signature.name();return i.createElement(tt.z,{className:t.className,fill:e.fill},n)}}]),t}(i.Component);nt.className="sig-tag";var at=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=("string"===typeof this.props.field?this.props.field:this.props.nameFunction?this.props.nameFunction(this.props.field):this.props.field.name()).split("<:");return i.createElement(tt.z,{className:t.className,fill:!0},t.FieldTagEls(e))}}],[{key:"FieldTagEls",value:function(e){return 2!==e.length?i.createElement(i.Fragment,null,e.join("")):i.createElement(i.Fragment,null,e[0],i.createElement(tt.k,{icon:"symbol-triangle-down",iconSize:14,style:{padding:"1px",transform:"rotate(90deg)"}}),e[1])}}]),t}(i.Component);at.className="field-tag";var it=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,n="string"===typeof e.skolem?e.skolem:e.nameFunction?e.nameFunction(e.skolem):e.skolem.name();return i.createElement(tt.z,{className:t.className,fill:!0},n)}}]),t}(i.Component);function rt(e,t){return{id:"Fields",children:(t?e.filter((function(e){return e.tuples().length})):e).map((function(e){return{id:e.id(),label:at.FieldTagEls(e.id().split("<:")),icon:"flows",children:[]}}))}}it.className="skolem-tag";var lt={collapsed:Object(Se.b)({Fields:!1,Skolems:!1}),collapseEdgeStyle:!1,collapseScheme:!1,fields:[],hideEmptyFields:!0,labelStyles:Object(Se.b)(),linkStyles:Object(Se.b)(),selected:null,skolems:[],treeField:null,treeSkolem:null},ot=Object(ke.a)({name:"edgestyles",initialState:lt,reducers:{clearAll:function(e){e.labelStyles=e.labelStyles.map((function(){return{}})),e.linkStyles=e.linkStyles.map((function(){return{}}))},clearCurrent:function(e){e.selected&&(e.labelStyles=e.labelStyles.set(e.selected,{}),e.linkStyles=e.linkStyles.set(e.selected,{}))},collapseTreeNode:function(e,t){var n=t.payload;e.collapsed=e.collapsed.set(n,!0)},expandTreeNode:function(e,t){var n=t.payload;e.collapsed=e.collapsed.set(n,!1)},selectTreeNode:function(e,t){var n=t.payload;(e.linkStyles.has(n)||"Fields"===n||"Skolems"===n)&&(e.selected=n)},setColorScheme:function(e,t){var n=t.payload;n.length&&(e.linkStyles=e.linkStyles.withMutations((function(t){[].concat(Object(J.a)(e.fields),Object(J.a)(e.skolems)).forEach((function(a,i){var r=a.id(),l=n[i%n.length],o=e.linkStyles.get(r);if(o){var s=ie(o);s.stroke=l,t.set(r,s)}}))})),e.labelStyles=e.labelStyles.withMutations((function(t){[].concat(Object(J.a)(e.fields),Object(J.a)(e.skolems)).forEach((function(a,i){var r=a.id(),l=n[i%n.length],o=e.labelStyles.get(r);if(o){var s=ne(o);s.color=l,t.set(r,s)}}))})))},setLabelColor:function(e,t){if(e.selected){var n=e.labelStyles.get(e.selected);if(n){var a=t.payload,i=n?ne(n):{};null===a?delete i.color:i.color=a,e.labelStyles=e.labelStyles.set(e.selected,i)}}},setLabelSize:function(e,t){if(e.selected){var n=e.labelStyles.get(e.selected);if(n){var a=parseInt(t.payload),i=n?ne(n):{};isNaN(a)||0===a?delete i.font:i.font="".concat(a,"px sans-serif"),e.labelStyles=e.labelStyles.set(e.selected,i)}}},setStroke:function(e,t){if(e.selected){var n=e.linkStyles.get(e.selected);if(n){var a=t.payload,i=ie(n);null===a?delete i.stroke:i.stroke=a,e.linkStyles=e.linkStyles.set(e.selected,i)}}},setStrokeWidth:function(e,t){if(e.selected){var n=e.linkStyles.get(e.selected);if(n){var a=parseInt(t.payload),i=ie(n);isNaN(a)||0===a?delete i.strokeWidth:i.strokeWidth=a,e.linkStyles=e.linkStyles.set(e.selected,i)}}},toggleCollapseEdgeStyle:function(e){e.collapseEdgeStyle=!e.collapseEdgeStyle},toggleCollapseScheme:function(e){e.collapseScheme=!e.collapseScheme},toggleHideEmptyFields:function(e){e.hideEmptyFields=!e.hideEmptyFields,e.treeField=rt(e.fields,e.hideEmptyFields)}},extraReducers:function(e){return e.addCase(Oe,(function(e,t){var n=t.payload;if(n){var a=n.fields(),i=n.skolems().filter((function(e){return e.arity()>1})),r=[].concat(Object(J.a)(a),Object(J.a)(i));e.fields=a,e.skolems=i,e.treeField=rt(a,e.hideEmptyFields),e.treeSkolem=function(e){return{id:"Skolems",children:e.map((function(e){return{id:e.id(),icon:"flows",children:[]}}))}}(i),e.labelStyles=Object(Se.b)(r.map((function(t){var n=t.id();return e.labelStyles.has(n)?[n,ne(e.labelStyles.get(n))]:[n,{}]}))),e.linkStyles=Object(Se.b)(r.map((function(t){var n=t.id();return e.linkStyles.has(n)?[n,ie(e.linkStyles.get(n))]:[n,{}]}))),e.labelStyles.has("Fields")||(e.labelStyles=e.labelStyles.set("Fields",{})),e.labelStyles.has("Skolems")||(e.labelStyles=e.labelStyles.set("Skolems",{})),e.linkStyles.has("Fields")||(e.linkStyles=e.linkStyles.set("Fields",{strokeWidth:2})),e.linkStyles.has("Skolems")||(e.linkStyles=e.linkStyles.set("Skolems",{strokeWidth:2}));var l=Ye[2][1].concat(Ye[1][1]).concat(Ye[0][1]),o=0;e.linkStyles=e.linkStyles.withMutations((function(t){[].concat(Object(J.a)(e.fields),Object(J.a)(e.skolems)).forEach((function(n){var a=n.id(),i=e.linkStyles.get(a);if(i&&!i.stroke&&n.tuples().length){var r=ie(i);r.stroke=l[o%l.length],t.set(a,r),o+=1}}))})),o=0,e.labelStyles=e.labelStyles.withMutations((function(t){[].concat(Object(J.a)(e.fields),Object(J.a)(e.skolems)).forEach((function(n){var a=n.id(),i=e.labelStyles.get(a);if(i&&!i.color&&n.tuples().length){var r=ne(i);r.color=l[o%l.length],t.set(a,r),o+=1}}))}))}else e.fields=[],e.labelStyles=Object(Se.b)(),e.linkStyles=Object(Se.b)(),e.selected=null,e.skolems=[],e.treeField=null,e.treeSkolem=null}))}}),st=ot.actions,ct=st.clearAll,ut=st.clearCurrent,ht=st.collapseTreeNode,dt=st.expandTreeNode,ft=st.selectTreeNode,pt=st.setColorScheme,gt=st.setLabelColor,mt=st.setLabelSize,vt=st.setStroke,bt=st.setStrokeWidth,yt=st.toggleCollapseEdgeStyle,_t=st.toggleCollapseScheme,kt=st.toggleHideEmptyFields,St=ot.reducer,Et=Object(ke.a)({name:"graphsettings",initialState:{axesVisible:!1,bundleFactor:.15,collapseEdgeSettings:!1,collapseGraphSettings:!1,gridVisible:!1,edgeLabelPlacement:"spread"},reducers:{setBundleFactor:function(e,t){var n=t.payload;n>=0&&(e.bundleFactor=n)},setLabelPlacement:function(e,t){e.edgeLabelPlacement=t.payload},toggleAxesVisible:function(e){e.axesVisible=!e.axesVisible},toggleCollapseEdgeSettings:function(e){e.collapseEdgeSettings=!e.collapseEdgeSettings},toggleCollapseGraphSettings:function(e){e.collapseGraphSettings=!e.collapseGraphSettings},toggleGridVisible:function(e){e.gridVisible=!e.gridVisible}}}),xt=Et.actions,jt=xt.setBundleFactor,Ot=xt.setLabelPlacement,wt=xt.toggleAxesVisible,Ct=xt.toggleCollapseEdgeSettings,Mt=xt.toggleCollapseGraphSettings,Tt=xt.toggleGridVisible,Lt=Et.reducer,Dt={align:void 0,collapseLayout:!1,collapseQuickLayout:!1,collapseZoom:!1,nodesep:100,rankdir:"BT",ranker:"network-simplex",ranksep:200},Rt=Object(ke.a)({name:"layout",initialState:Dt,reducers:{setAlign:function(e,t){e.align=t.payload},setNodeSep:function(e,t){e.nodesep=t.payload},setRankDir:function(e,t){e.rankdir=t.payload},setRanker:function(e,t){e.ranker=t.payload},setRankSep:function(e,t){e.ranksep=t.payload},toggleCollapseLayout:function(e){e.collapseLayout=!e.collapseLayout},toggleCollapseQuickLayout:function(e){e.collapseQuickLayout=!e.collapseQuickLayout},toggleCollapseZoom:function(e){e.collapseZoom=!e.collapseZoom}}}),Nt=Rt.actions,At=Nt.setAlign,Ft=Nt.setNodeSep,Vt=Nt.setRankDir,Pt=Nt.setRanker,It=Nt.setRankSep,zt=Nt.toggleCollapseLayout,Wt=Nt.toggleCollapseQuickLayout,Ht=Nt.toggleCollapseZoom,Bt=Rt.reducer;function Gt(e,t){if(!e)return null;return function e(n){var a=(t?n.subTypes().filter((function(e){return e.atoms().length||e.subTypes().length})):n.subTypes()).map(e);return{id:n.id(),icon:"group-objects",children:a}}(e)}var qt,Zt,Ut,Qt,Xt,Yt={collapsed:Object(Se.b)(),collapseNodeStyle:!1,collapseScheme:!1,hideDisconnected:Object(Se.b)(),hideEmptySets:!0,labels:Object(Se.b)(),nodeTree:null,selected:null,shapes:Object(Se.b)(),signatures:[],univ:null},Jt=Object(ke.a)({name:"nodestyles",initialState:Yt,reducers:{clearAll:function(e){e.labels=e.labels.map((function(){return{}})),e.shapes=e.shapes.map((function(){return{}}))},clearCurrent:function(e){e.selected&&(e.labels=e.labels.set(e.selected,{}),e.shapes=e.shapes.set(e.selected,{}))},collapseTreeNode:function(e,t){var n=t.payload;e.collapsed=e.collapsed.set(n,!0)},expandTreeNode:function(e,t){var n=t.payload;e.collapsed=e.collapsed.set(n,!1)},selectTreeNode:function(e,t){var n=t.payload;e.shapes.has(n)&&(e.selected=n)},setColorScheme:function(e,t){var n=t.payload;n.length&&(e.shapes=e.shapes.withMutations((function(t){var a=0;e.signatures.forEach((function(i){var r=i.id(),l=e.shapes.get(r);if(l&&i.atoms().length){var o=x(l);o.fill=n[a++%n.length],t.set(r,o)}}))})),e.labels=e.labels.withMutations((function(t){e.signatures.forEach((function(n){var a=n.id(),i=e.shapes.get(a),r=e.labels.get(a);if(r&&i&&i.fill){var l=ne(r);l.color=et(i.fill),t.set(a,l)}}))})))},setFill:function(e,t){if(e.selected){var n=e.shapes.get(e.selected);if(n){var a=t.payload,i=n?x(n):{};null===a?delete i.fill:i.fill=a,e.shapes=e.shapes.set(e.selected,i)}}},setHeight:function(e,t){if(e.selected){var n=e.shapes.get(e.selected);if(n&&"rectangle"===n.type){var a=parseInt(t.payload),i=x(n);isNaN(a)||0===a?delete i.height:i.height=a,e.shapes=e.shapes.set(e.selected,i)}}},setLabelColor:function(e,t){if(e.selected){var n=e.labels.get(e.selected);if(n){var a=t.payload,i=n?ne(n):{};null===a?delete i.color:i.color=a,e.labels=e.labels.set(e.selected,i)}}},setLabelSize:function(e,t){if(e.selected){var n=e.labels.get(e.selected);if(n){var a=n?ne(n):{},i=parseInt(t.payload);isNaN(i)||0===i?delete a.font:a.font="".concat(i,"px sans-serif"),e.labels=e.labels.set(e.selected,a)}}},setRadius:function(e,t){if(e.selected){var n=e.shapes.get(e.selected);if(n&&"circle"===n.type){var a=parseInt(t.payload),i=x(n);isNaN(a)||0===a?delete i.radius:i.radius=a,e.shapes=e.shapes.set(e.selected,i)}}},setShape:function(e,t){if(e.selected){var n=e.shapes.get(e.selected),a=t.payload;if(void 0===n)return;if(n&&n.type!==a||n!==a){var i=function(e,t){var n={};return E(n,e),"circle"===t&&(n.type="circle",n.radius=O(e)?Math.min(e.width||35,e.height||35):35),"rectangle"===t&&(n.type="rectangle",n.width=j(e)?2*(e.radius||40):80,n.height=j(e)?e.radius:40),n}(n,a);e.shapes=e.shapes.set(e.selected,i)}}},setStroke:function(e,t){if(e.selected){var n=e.shapes.get(e.selected);if(n){var a=t.payload,i=x(n);null===a?delete i.stroke:i.stroke=a,e.shapes=e.shapes.set(e.selected,i)}}},setStrokeWidth:function(e,t){if(e.selected){var n=e.shapes.get(e.selected);if(n){var a=parseInt(t.payload),i=x(n);isNaN(a)||-1===a?delete i.strokeWidth:i.strokeWidth=a,e.shapes=e.shapes.set(e.selected,i)}}},setWidth:function(e,t){if(e.selected){var n=e.shapes.get(e.selected);if(n&&"rectangle"===n.type){var a=parseInt(t.payload),i=x(n);isNaN(a)||0===a?delete i.width:i.width=a,e.shapes=e.shapes.set(e.selected,i)}}},toggleCollapseNodeStyle:function(e){e.collapseNodeStyle=!e.collapseNodeStyle},toggleCollapseScheme:function(e){e.collapseScheme=!e.collapseScheme},toggleHideDisconnected:function(e){var t=e.selected;if(t){var n=!e.hideDisconnected.get(t);e.hideDisconnected=e.hideDisconnected.set(t,n)}},toggleHideEmptySets:function(e){e.hideEmptySets=!e.hideEmptySets,e.nodeTree=Gt(e.univ,e.hideEmptySets)}},extraReducers:function(e){return e.addCase(Oe,(function(e,t){var n=t.payload;if(null!==n){var a=n.signatures(),i=a.find((function(e){return"univ"===e.id()}))||null;e.signatures=a,e.univ=i,e.nodeTree=Gt(i,e.hideEmptySets),e.collapsed=Object(Se.b)(a.map((function(t){var n=t.id();return e.collapsed.has(n)?[n,!!e.collapsed.get(n)]:[n,!1]}))),e.hideDisconnected=Object(Se.b)(a.map((function(t){var n=t.id();return e.hideDisconnected.has(n)?[n,!!e.hideDisconnected.get(n)]:[n,!0]}))),e.labels=Object(Se.b)(a.map((function(t){var n=t.id();return e.labels.has(n)?[n,ne(e.labels.get(n))]:[n,{}]}))),e.shapes=Object(Se.b)(a.map((function(t){var n=t.id();return e.shapes.has(n)?[n,x(e.shapes.get(n))]:[n,{}]}))),e.shapes=e.shapes.withMutations((function(t){a.forEach((function(n){var a=n.id(),i=e.shapes.get(a);if(i&&!i.fill){var r=x(i);r.fill="#ecd12e",t.set(a,r)}}))})),e.labels=e.labels.withMutations((function(t){a.forEach((function(n){var a=n.id(),i=e.shapes.get(a),r=e.labels.get(a);if(r&&i&&i.fill){var l=ne(r);l.color=et(i.fill),t.set(a,l)}}))})),e.selected&&!e.shapes.has(e.selected)&&(e.selected=null)}else e.collapsed=Object(Se.b)(),e.hideDisconnected=Object(Se.b)(),e.labels=Object(Se.b)(),e.nodeTree=null,e.shapes=Object(Se.b)(),e.selected=null,e.univ=null}))}}),$t=Jt.actions,Kt=$t.clearAll,en=$t.clearCurrent,tn=$t.collapseTreeNode,nn=$t.expandTreeNode,an=$t.selectTreeNode,rn=$t.setColorScheme,ln=$t.setFill,on=$t.setHeight,sn=$t.setLabelColor,cn=$t.setLabelSize,un=$t.setRadius,hn=$t.setShape,dn=$t.setStroke,fn=$t.setStrokeWidth,pn=$t.setWidth,gn=$t.toggleCollapseNodeStyle,mn=$t.toggleCollapseScheme,vn=$t.toggleHideDisconnected,bn=$t.toggleHideEmptySets,yn=Jt.reducer,_n={graph:new be},kn=Object(ke.a)({name:"graph",initialState:_n,reducers:{}}),Sn=Object(a.combineReducers)({dataSlice:He,edgeStylingSlice:St,graphSlice:kn.reducer,graphSettingsSlice:Lt,layoutSlice:Bt,nodeStylingSlice:yn}),En=Object(ke.a)({name:"source",initialState:{selected:null},reducers:{setSelected:function(e,t){e.selected=t.payload}},extraReducers:function(e){return e.addCase(Oe,(function(e){e.selected=null}))}}),xn=En.actions.setSelected,jn=En.reducer;!function(e){e[e.Left=0]="Left",e[e.Center=1]="Center",e[e.Right=2]="Right"}(qt||(qt={})),function(e){e[e.Row=0]="Row",e[e.Column=1]="Column"}(Zt||(Zt={})),function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending"}(Ut||(Ut={})),function(e){e[e.Alphabetical=0]="Alphabetical",e[e.Builtin=1]="Builtin",e[e.Group=2]="Group",e[e.Size=3]="Size"}(Qt||(Qt={})),function(e){e[e.All=0]="All",e[e.Signatures=1]="Signatures",e[e.Fields=2]="Fields",e[e.Skolems=3]="Skolems",e[e.Select=4]="Select"}(Xt||(Xt={}));var On=["#2965CC","#29A634","#D99E0B","#D13913","#8F398F","#00B3A4","#DB2C6F","#9BBF30","#96622D","#7157D9"];function wn(e){return function(t){return e?t.id().replace(/^this\//,""):t.id()}}function Cn(e,t){return e.method===Qt.Size?p.d.sizeSort(e.direction===Ut.Ascending):e.method===Qt.Alphabetical?p.d.alphabeticalSort(t,e.direction===Ut.Ascending):e.method===Qt.Group?p.d.groupSort():function(){return 0}}var Mn={alignment:qt.Left,collapseData:!1,collapseLayout:!1,collapseTables:!1,data:[],dataSelected:[],highlightSkolems:!0,layoutDirection:Zt.Row,removeBuiltin:!0,removeEmpty:!0,removeThis:!0,primarySort:{method:Qt.Group,direction:Ut.Descending},secondarySort:{method:Qt.Size,direction:Ut.Descending},skolemColors:new Map,tablesType:Xt.All},Tn=Object(ke.a)({name:"table",initialState:Mn,reducers:{clearSelectedData:function(e){e.dataSelected=[]},deselectData:function(e,t){var n=e.dataSelected.indexOf(t.payload);-1!==n&&e.dataSelected.splice(n,1),e.tablesType=Xt.Select},selectData:function(e,t){e.dataSelected.includes(t.payload)||e.dataSelected.push(t.payload),e.tablesType=Xt.Select},setAlignment:function(e,t){e.alignment=t.payload},setLayoutDirection:function(e,t){e.layoutDirection=t.payload},setSort:function(e,t){e.primarySort.method!==t.payload.method&&(e.secondarySort=e.primarySort),e.primarySort=t.payload},setTableTypes:function(e,t){e.tablesType=t.payload},toggleCollapseData:function(e){e.collapseData=!e.collapseData},toggleCollapseLayout:function(e){e.collapseLayout=!e.collapseLayout},toggleCollapseTables:function(e){e.collapseTables=!e.collapseTables},toggleHighlightSkolems:function(e){e.highlightSkolems=!e.highlightSkolems,e.highlightSkolems&&e.tablesType===Xt.Skolems&&(e.tablesType=Xt.All)},toggleRemoveBuiltin:function(e){e.removeBuiltin=!e.removeBuiltin},toggleRemoveEmpty:function(e){e.removeEmpty=!e.removeEmpty},toggleRemoveThis:function(e){e.removeThis=!e.removeThis}},extraReducers:function(e){return e.addCase(Oe,(function(e,t){var n=t.payload;if(n){var a=n.skolems();e.data=[].concat(Object(J.a)(n.signatures()),Object(J.a)(n.fields()),Object(J.a)(a)),e.skolemColors=new Map(a.map((function(e,t){return[e,On[t%a.length]]}))),e.dataSelected=e.dataSelected.filter((function(t){return void 0!==e.data.find((function(e){return e.id()===t.id()}))}))}}))}}),Ln=Tn.actions,Dn=Ln.clearSelectedData,Rn=Ln.deselectData,Nn=Ln.selectData,An=Ln.setAlignment,Fn=Ln.setLayoutDirection,Vn=Ln.setSort,Pn=Ln.setTableTypes,In=Ln.toggleCollapseData,zn=Ln.toggleCollapseLayout,Wn=Ln.toggleCollapseTables,Hn=Ln.toggleHighlightSkolems,Bn=Ln.toggleRemoveBuiltin,Gn=Ln.toggleRemoveEmpty,qn=Ln.toggleRemoveThis,Zn=Tn.reducer,Un=Object(a.combineReducers)({graphSlice:Sn,sourceSlice:jn,sterlingSlice:Te,tableSlice:Zn}),Qn=n(25),Xn=n(906),Yn=n(280),Jn=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this)))._connection=void 0,n._expressions=void 0,n._pending=void 0,n._connection=e,n._expressions=[],n._pending=null,e.addEventListener("eval",(function(e){n._parse(e.data)})),n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"clear",value:function(){this._expressions=[]}},{key:"evaluate",value:function(e){this._request({id:t._nextid++,error:!1,expression:e,result:null})}},{key:"expressions",value:function(){return this._expressions}},{key:"_parse",value:function(e){var t=this._pending,n=e.match(/(-?\d+):(.*)/);if(null!==n){var a=parseInt(n[1]);if(t&&t.id===a){var i=n[2].trim();"ERR:"===i.slice(0,4)?(t.result=i.slice(4),t.error=!0):(t.result=i,t.error=!1),this._expressions.push(t),this._setPending(null)}}}},{key:"_request",value:function(e){this._setPending(e),this._connection.requestEvaluateExpression(e.id,e.expression)||this._parse("".concat(e.id,":ERR:Error: Not Connected"))}},{key:"_setPending",value:function(e){this._pending=e,null!==e?this.dispatchEvent({type:"pending"}):this.dispatchEvent({type:"ready"})}}]),t}(g);Jn._nextid=0;var $n=n(59);var Kn=function(e){return r.a.createElement("table",{className:"bp3-html-table bp3-html-table-condensed bp3-html-table-striped .bp3-interactive"},r.a.createElement("tbody",null,function(e){if("{"===e[0]&&"}"===e[e.length-1]){return e.slice(1,-1).split(",").map((function(e){return e.split("->")}))}return[]}(e.result).map((function(e,t){return r.a.createElement("tr",{key:t},e.map((function(e,t){return r.a.createElement("td",{key:t},e)})))}))))};var ea=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e)))._botRef=void 0,n._textRef=void 0,n._onDown=function(){var e=n._textRef.current;if(e&&e.selectionStart===e.value.length){var t=n.state.history<n.state.count?n.state.history+1:n.state.count;n.setState({history:t})}},n._onEnter=function(){var e=n._textRef.current;if(e){var t=e.value;e.value="",t.length&&n.props.evaluator.evaluate(t)}},n._onKeyDown=function(e){switch(e.key){case"Enter":e.preventDefault(),n._onEnter();break;case"ArrowUp":n._onUp();break;case"ArrowDown":n._onDown()}},n._onPending=function(){n._setActive(!1)},n._onReady=function(){n._setActive(!0);var e=n.props.evaluator.expressions();n.setState({count:e.length,expressions:e,history:e.length})},n._onUp=function(){var e=n._textRef.current;if(e&&0===e.selectionStart){var t=n.state.history>0?n.state.history-1:0;n.setState({history:t})}},n._scrollDown=function(){var e=n._botRef.current;e&&e.scrollIntoView()},n._setActive=function(e){var t=n._textRef.current;t&&(t.readOnly=!e)},n._setText=function(e){var t=n._textRef.current;t&&(t.value=e)};var a=e.evaluator;a.addEventListener("pending",n._onPending),a.addEventListener("ready",n._onReady),n._botRef=r.a.createRef(),n._textRef=r.a.createRef();var i=e.evaluator.expressions();return n.state={count:i.length,expressions:i,history:i.length,table:!1},n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this._scrollDown()}},{key:"componentDidUpdate",value:function(e,t){t.count!==this.state.count&&this._scrollDown()}},{key:"componentWillUnmount",value:function(){var e=this.props.evaluator;e.removeEventListener("pending",this._onPending),e.removeEventListener("ready",this._onReady)}},{key:"render",value:function(){var e=this,t=this.state,n=r.a.createElement(tt.k,{icon:"blank",iconSize:12}),a=r.a.createElement(tt.k,{icon:"cross",iconSize:12});return t.history<t.count?this._setText(t.expressions[t.history].expression):this._setText(""),r.a.createElement("div",{className:"evaluator"},r.a.createElement("div",{className:"evaluator-bar bp3-dark"},r.a.createElement(tt.C,{content:"Clear",hoverOpenDelay:500,intent:$n.a.PRIMARY},r.a.createElement(tt.a,{small:!0,minimal:!0,icon:"clean",onClick:function(){e.props.evaluator.clear();var t=e.props.evaluator.expressions();e.setState({expressions:t,count:t.length,history:t.length})}})),r.a.createElement(tt.C,{content:t.table?"Display Text":"Display Tables",hoverOpenDelay:500,intent:$n.a.PRIMARY},r.a.createElement(tt.a,{small:!0,minimal:!0,icon:t.table?"align-left":"th",onClick:function(){return e.setState({table:!t.table})}}))),r.a.createElement("div",{className:"evaluator-output"},t.expressions.length?t.expressions.map((function(e){return r.a.createElement(tt.c,{key:e.id,icon:e.error?a:n,title:e.expression,intent:e.error?$n.a.DANGER:$n.a.NONE},t.table&&function(e){var t=e.result;return!e.error&&"string"===typeof t&&t.length>0&&"{"===t[0]&&"}"===t[t.length-1]}(e)&&"string"===typeof e.result?r.a.createElement(Kn,{result:e.result}):e.result)})):r.a.createElement(tt.r,{title:"Evaluator",description:"The evaluator allows you to type in Alloy expressions and see their values. For example, 'univ' shows the list of atoms. Type an expression below and press Enter to evaluate (you can press the up and down arrow keys to recall old inputs).",icon:"console"}),r.a.createElement("div",{ref:this._botRef})),r.a.createElement("div",{className:"evaluator-input"},r.a.createElement("textarea",{autoComplete:"off",placeholder:"Enter an expression...",spellCheck:"false",onKeyDown:this._onKeyDown,ref:this._textRef})))}}]),t}(r.a.Component),ta=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"drawer"},this.props.children)}}]),t}(r.a.Component);ta.Section=function(e){var t=e.collapsed?"expand-all":"collapse-all";return r.a.createElement("div",{className:"section ".concat(e.collapsed?"collapsed":""),style:e.style},!!e.title&&r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"title"},e.title.toUpperCase()),e.onToggle&&r.a.createElement(tt.a,{icon:t,minimal:!0,onClick:e.onToggle})),r.a.createElement(tt.e,{isOpen:!e.collapsed,keepChildrenMounted:!0},r.a.createElement("div",{className:"body"},e.children)))};var na=ta,aa=function(e){return r.a.createElement(tt.b,{minimal:!0,style:{flexWrap:"wrap",maxHeight:"15px",overflow:"hidden"}},Ye.map((function(t){var n=Object(w.a)(t,2),a=n[0],i=n[1];return r.a.createElement(tt.C,{content:a,key:a},r.a.createElement(tt.a,{minimal:!0,style:{background:Ke(i.slice(0,6)),margin:"0 5px",minWidth:"40px",minHeight:"15px"},onClick:function(){return e.onClick(i)}}))})))},ia={setColorScheme:pt,toggleCollapseScheme:_t},ra=Object(s.b)((function(e){return{collapse:e.graphSlice.edgeStylingSlice.collapseScheme}}),ia)((function(e){return r.a.createElement(na.Section,{collapsed:e.collapse,onToggle:e.toggleCollapseScheme,title:"Quick Color Scheme"},r.a.createElement(aa,{onClick:e.setColorScheme}))})),la=[{value:"center",label:"Center"},{value:"join",label:"Join"},{value:"spread",label:"Spread"}],oa={setBundleFactor:jt,setLabelPlacement:Ot,toggleCollapseEdgeSettings:Ct},sa=Object(s.b)((function(e){return Object(Qn.a)({},e.graphSlice.graphSettingsSlice)}),oa)((function(e){return r.a.createElement(na.Section,{collapsed:e.collapseEdgeSettings,onToggle:e.toggleCollapseEdgeSettings,title:"Edge Settings"},r.a.createElement(tt.h,{inline:!0,label:"Bundle Factor"},r.a.createElement(tt.s,{allowNumericCharactersOnly:!0,fill:!1,value:e.bundleFactor,min:0,minorStepSize:.001,stepSize:.01,majorStepSize:.1,onValueChange:function(t){return e.setBundleFactor(t)}})),r.a.createElement(tt.h,{inline:!0,label:"Label Placement"},r.a.createElement(tt.i,{minimal:!0,options:la,value:e.edgeLabelPlacement,onChange:function(t){e.setLabelPlacement(t.target.value)}})))})),ca=[{value:"undefined",label:"---"},{value:"UL",label:"Bottom Left"},{value:"UR",label:"Bottom Right"},{value:"DL",label:"Top Left"},{value:"DR",label:"Top Right"}],ua=[{value:"TB",label:"Bottom to Top"},{value:"BT",label:"Top to Bottom"},{value:"LR",label:"Left to Right"},{value:"RL",label:"Right to Left"}],ha=[{value:"network-simplex",label:"Network Simplex"},{value:"tight-tree",label:"Tight Tree"},{value:"longest-path",label:"Longest Path"}],da={setAlign:At,setNodeSep:Ft,setRankDir:Vt,setRanker:Pt,setRankSep:It,toggleCollapseLayout:zt},fa=Object(s.b)((function(e){return{collapseLayout:e.graphSlice.layoutSlice.collapseLayout,graph:e.graphSlice.graphSlice.graph,options:e.graphSlice.layoutSlice}}),da)((function(e){var t=Object.assign({},e.options);return r.a.createElement(na.Section,{collapsed:e.collapseLayout,onToggle:e.toggleCollapseLayout,title:"Layout"},r.a.createElement(tt.h,{inline:!0,label:"Align"},r.a.createElement(tt.i,{minimal:!0,options:ca,value:void 0===t.align?"undefined":t.align,onChange:function(t){var n="undefined"===t.target.value?void 0:t.target.value;e.setAlign(n)}})),r.a.createElement(tt.h,{inline:!0,label:"Node Separation"},r.a.createElement(tt.s,{allowNumericCharactersOnly:!0,fill:!1,value:t.nodesep,onValueChange:function(t){return e.setNodeSep(t)}})),r.a.createElement(tt.h,{inline:!0,label:"Ranking Method"},r.a.createElement(tt.i,{minimal:!0,options:ha,value:t.ranker,onChange:function(t){return e.setRanker(t.target.value)}})),r.a.createElement(tt.h,{inline:!0,label:"Rank Direction"},r.a.createElement(tt.i,{minimal:!0,options:ua,value:t.rankdir,onChange:function(t){return e.setRankDir(t.target.value)}})),r.a.createElement(tt.h,{inline:!0,label:"Rank Separation"},r.a.createElement(tt.s,{allowNumericCharactersOnly:!0,fill:!1,value:t.ranksep,onValueChange:function(t){return e.setRankSep(t)}})),r.a.createElement(tt.a,{minimal:!0,text:"Apply Layout",onClick:function(){e.graph&&((new N).apply(e.graph,t),e.graph.update())}}))})),pa={toggleCollapseZoom:Ht},ga=Object(s.b)((function(e){return{collapseZoom:e.graphSlice.layoutSlice.collapseZoom,graph:e.graphSlice.graphSlice.graph}}),pa)((function(e){return r.a.createElement(na.Section,{collapsed:e.collapseZoom,onToggle:e.toggleCollapseZoom,title:"Zoom Settings"},r.a.createElement(tt.a,{icon:"home",text:"Default Zoom",minimal:!0,onClick:function(){e.graph.zoomToHome()}}),r.a.createElement(tt.a,{icon:"zoom-to-fit",text:"Zoom to Fit",minimal:!0,onClick:function(){e.graph.zoomToFit()}}))})),ma={setColorScheme:rn,toggleCollapseScheme:mn},va=Object(s.b)((function(e){return{collapse:e.graphSlice.nodeStylingSlice.collapseScheme}}),ma)((function(e){return r.a.createElement(na.Section,{collapsed:e.collapse,onToggle:e.toggleCollapseScheme,title:"Quick Color Scheme"},r.a.createElement(aa,{onClick:e.setColorScheme}))})),ba=n(27),ya={addProjection:Ae,nextAtom:Fe,previousAtom:Ve,removeProjection:Pe,setProjection:Ie,toggleCollapseProjections:We},_a=Object(s.b)((function(e){return Object(Qn.a)({},e.graphSlice.dataSlice)}),ya)((function(e){var t=e.projections.toArray();return r.a.createElement(na.Section,{collapsed:e.collapseProjections,onToggle:e.toggleCollapseProjections,title:"Projections"},r.a.createElement("div",{className:"projections"},t.map((function(t){var n=t[0],a=t[1],i=e.atoms.get(n)||[];return r.a.createElement(r.a.Fragment,{key:n},r.a.createElement(tt.B,{ellipsize:!0},n),r.a.createElement(tt.i,{minimal:!0,onChange:function(t){e.setProjection({sig:n,atom:t.target.value})},options:i,value:a}),r.a.createElement("div",{className:"buttons"},r.a.createElement(tt.a,{icon:"chevron-left",minimal:!0,onClick:function(){return e.previousAtom(n)}}),r.a.createElement(tt.a,{icon:"cross",minimal:!0,onClick:function(){return e.removeProjection(n)}}),r.a.createElement(tt.a,{icon:"chevron-right",minimal:!0,onClick:function(){return e.nextAtom(n)}})))}))),e.unprojected.size>0&&r.a.createElement(tt.t,{className:"centered",hasBackdrop:!0,modifiers:Xe,position:ba.a.BOTTOM,usePortal:!0,wrapperTagName:"div"},r.a.createElement(tt.a,{icon:"add",minimal:!0,text:"Add Projection"}),r.a.createElement(tt.f,{vertical:!0},e.unprojected.map((function(t){return r.a.createElement(tt.a,{key:t,minimal:!0,onClick:function(){return e.addProjection(t)},text:t})})))))})),ka=n(87),Sa=n(68),Ea=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(tt.h,{inline:!0,label:"Label Size (px)"},r.a.createElement(tt.s,{allowNumericCharactersOnly:!0,fill:!1,min:0,minorStepSize:null,onValueChange:function(t,n){return e.onChangeSize(n)},placeholder:"Inheret",value:e.size})),r.a.createElement(tt.h,{inline:!0,label:"Label Color"},e.color&&r.a.createElement(tt.a,{icon:"small-cross",onClick:function(){return e.onChangeColor(null)},minimal:!0}),r.a.createElement(tt.t,{hasBackdrop:!0,usePortal:!0,modifiers:Xe,position:ba.a.LEFT},r.a.createElement(tt.a,{style:{backgroundColor:$e(e.color),color:et(e.color)},text:e.color||"Inheret",minimal:!0}),r.a.createElement(Sa.TwitterPicker,{color:$e(e.color),colors:Je,onChange:function(t){return e.onChangeColor(t.hex)},triangle:"hide"}))))};function xa(e,t,n){if(null===e)return{id:"error",label:"No Instance",icon:"error"};return function e(a){var i=a.children.map(e);return{id:a.id,label:a.label?a.label:a.id,icon:a.icon,isExpanded:!t.get(a.id),isSelected:a.id===n,hasCaret:!!i.length,childNodes:i}}(e)}var ja=function(e){var t=e.stroke;return r.a.createElement(r.a.Fragment,null,r.a.createElement(tt.h,{inline:!0,label:"Stroke"},e.stroke&&r.a.createElement(tt.a,{icon:"small-cross",onClick:function(){return e.onChangeStroke(null)},minimal:!0}),r.a.createElement(tt.t,{hasBackdrop:!0,usePortal:!0,modifiers:Xe,position:ba.a.LEFT},r.a.createElement(tt.a,{style:{backgroundColor:$e(t),color:et(t)},text:t||"Inherit",minimal:!0}),r.a.createElement(Sa.TwitterPicker,{color:$e(t),colors:Je,onChange:function(t){return e.onChangeStroke(t.hex)},triangle:"hide"}))),r.a.createElement(tt.h,{inline:!0,label:"Stroke Width"},r.a.createElement(tt.s,{allowNumericCharactersOnly:!0,fill:!1,min:0,onValueChange:function(t,n){return e.onChangeStrokeWidth(n)},placeholder:"Inherit",value:e.strokeWidth})))},Oa={clearAll:ct,clearCurrent:ut,collapseTreeNode:ht,expandTreeNode:dt,selectTreeNode:ft,setLabelColor:gt,setLabelSize:mt,setStroke:vt,setStrokeWidth:bt,toggleAsAttribute:ze,toggleCollapseEdgeStyle:yt,toggleHideEmptyFields:kt},wa=Object(s.b)((function(e){return Object(Qn.a)({},e.graphSlice.edgeStylingSlice,{asAttribute:e.graphSlice.dataSlice.asAttribute})}),Oa)((function(e){var t=e.selected,n=t&&e.linkStyles.get(t)||{},a=!!t&&e.asAttribute.get(t),i=n?n.stroke:void 0,l=n?n.strokeWidth:void 0,o=t&&e.labelStyles.get(t)||{},s=o?o.color:void 0,c=o?o.font:void 0,u=c?c.match(/(\d*)px/):[],h=u&&u.length>1?parseInt(u[1]):void 0,d=xa(e.treeField,e.collapsed,t),f=xa(e.treeSkolem,e.collapsed,t),p="error"===d.id&&"error"===f.id,g=f.childNodes&&f.childNodes.length,m=p||!g?[d]:[d,f],v=e.hideEmptyFields;return d.secondaryLabel=r.a.createElement(tt.C,{content:v?"Show Empty Fields":"Hide Empty Fields"},r.a.createElement(tt.a,{icon:v?"eye-off":"eye-open",minimal:!0,onClick:e.toggleHideEmptyFields})),r.a.createElement(r.a.Fragment,null,r.a.createElement(na.Section,{collapsed:e.collapseEdgeStyle,onToggle:e.toggleCollapseEdgeStyle,title:"Edge Styling"},r.a.createElement(tt.D,{contents:m,onNodeClick:function(t){return e.selectTreeNode(t.id.toString())},onNodeCollapse:function(t){return e.collapseTreeNode(t.id.toString())},onNodeExpand:function(t){return e.expandTreeNode(t.id.toString())}}),r.a.createElement(tt.g,null),t?r.a.createElement(r.a.Fragment,null,r.a.createElement(tt.h,null,r.a.createElement(tt.y,{alignIndicator:ka.a.RIGHT,checked:a,label:"Show as Attribute",onChange:function(){return e.toggleAsAttribute(t)}})),r.a.createElement(ja,{stroke:i,strokeWidth:l,onChangeStroke:e.setStroke,onChangeStrokeWidth:e.setStrokeWidth}),r.a.createElement(Ea,{color:s,size:h,onChangeColor:e.setLabelColor,onChangeSize:e.setLabelSize}),r.a.createElement(tt.b,{fill:!0,minimal:!0},r.a.createElement(tt.a,{icon:"clean",onClick:e.clearCurrent,text:"Clear Selected"}),r.a.createElement(tt.a,{icon:"clean",onClick:e.clearAll,text:"Clear All"}))):r.a.createElement(tt.r,{title:"Edge Styling",description:"Select a field or skolem from the tree",icon:"style"})))})),Ca={toggleAxesVisible:wt,toggleCollapseGraphSettings:Mt,toggleGridVisible:Tt},Ma=Object(s.b)((function(e){return Object(Qn.a)({},e.graphSlice.graphSettingsSlice)}),Ca)((function(e){return r.a.createElement(na.Section,{collapsed:e.collapseGraphSettings,onToggle:e.toggleCollapseGraphSettings,title:"Graph Settings"},r.a.createElement(tt.y,{alignIndicator:ka.a.RIGHT,checked:e.axesVisible,label:"Display Axes",onChange:e.toggleAxesVisible}),r.a.createElement(tt.y,{alignIndicator:ka.a.RIGHT,checked:e.gridVisible,label:"Display Grid",onChange:e.toggleGridVisible}))})),Ta={toggleCollapseQuickLayout:Wt},La=Object(s.b)((function(e){return{collapseQuickLayout:e.graphSlice.layoutSlice.collapseQuickLayout,graph:e.graphSlice.graphSlice.graph,instance:e.sterlingSlice.instance}}),Ta)((function(e){return r.a.createElement(na.Section,{collapsed:e.collapseQuickLayout,onToggle:e.toggleCollapseQuickLayout,title:"Quick Layout"},r.a.createElement(tt.b,{minimal:!0},r.a.createElement(tt.C,{content:"Circle Layout"},r.a.createElement(tt.a,{icon:"layout-circle",onClick:function(){e.graph&&((new y).apply(e.graph),e.graph.update())}})),r.a.createElement(tt.C,{content:"Grid Layout"},r.a.createElement(tt.a,{icon:"layout-grid",onClick:function(){e.graph&&((new ye).apply(e.graph),e.graph.update())}})),r.a.createElement(tt.C,{content:"Grouped Row Layout"},r.a.createElement(tt.a,{icon:"layout-linear",onClick:function(){if(e.graph&&e.instance){var t=new _e,n=e.instance.signatures().find((function(e){return"univ"===e.id()}));n&&t.groups(n.subTypes().map((function(e){return e.atoms(!0).map((function(e){return e.name()}))}))),t.apply(e.graph),e.graph.update()}}})),r.a.createElement(tt.C,{content:"Layered Layout"},r.a.createElement(tt.a,{icon:"layout-hierarchy",onClick:function(){e.graph&&((new N).apply(e.graph),e.graph.update())}}))))})),Da=function(e){var t=e.style.radius;return r.a.createElement(tt.h,{inline:!0,label:"Radius"},r.a.createElement(tt.s,{allowNumericCharactersOnly:!0,fill:!1,min:0,onValueChange:function(t,n){return e.onSetRadius(n)},placeholder:"Inherit",value:t||void 0}))},Ra=function(e){var t=e.style.width,n=e.style.height;return r.a.createElement(r.a.Fragment,null,r.a.createElement(tt.h,{inline:!0,label:"Width"},r.a.createElement(tt.s,{allowNumericCharactersOnly:!0,fill:!1,min:0,onValueChange:function(t,n){return e.onSetWidth(n)},placeholder:"Inherit",value:t||void 0})),r.a.createElement(tt.h,{inline:!0,label:"Height"},r.a.createElement(tt.s,{allowNumericCharactersOnly:!0,min:0,onValueChange:function(t,n){return e.onSetHeight(n)},placeholder:"Inherit",value:n||void 0})))};var Na=function(e){var t=e.shape,n=t&&t.type||"inherit";return r.a.createElement(r.a.Fragment,null,r.a.createElement(tt.h,{inline:!0,label:"Shape"},r.a.createElement(tt.i,{minimal:!0,options:[{value:"inherit",label:"Inherit"},{value:"circle",label:"Circle"},{value:"rectangle",label:"Rectangle"}],value:n,onChange:function(t){var n=t.target.value;e.onSetShape(function(e){return"circle"===e||"rectangle"===e?e:null}(n))}})),"circle"===n?r.a.createElement(Da,{style:t,onSetRadius:e.onSetRadius}):"rectangle"===n?r.a.createElement(Ra,{style:t,onSetWidth:e.onSetWidth,onSetHeight:e.onSetHeight}):null)},Aa=function(e){var t=e.fill,n=e.stroke;return r.a.createElement(r.a.Fragment,null,r.a.createElement(tt.h,{inline:!0,label:"Fill"},t&&r.a.createElement(tt.a,{icon:"small-cross",onClick:function(){return e.onChangeFill(null)},minimal:!0}),r.a.createElement(tt.t,{hasBackdrop:!0,usePortal:!0,modifiers:Xe,position:ba.a.LEFT},r.a.createElement(tt.a,{style:{backgroundColor:$e(t),color:et(t)},text:t||"Inherit",minimal:!0}),r.a.createElement(Sa.TwitterPicker,{color:$e(t),colors:Je,onChange:function(t){return e.onChangeFill(t.hex)},triangle:"hide"}))),r.a.createElement(tt.h,{inline:!0,label:"Stroke"},n&&r.a.createElement(tt.a,{icon:"small-cross",onClick:function(){return e.onChangeStroke(null)},minimal:!0}),r.a.createElement(tt.t,{hasBackdrop:!0,usePortal:!0,modifiers:Xe,position:ba.a.LEFT},r.a.createElement(tt.a,{style:{backgroundColor:$e(n),color:et(n)},text:n||"Inherit",minimal:!0}),r.a.createElement(Sa.TwitterPicker,{color:$e(n),colors:Je,onChange:function(t){return e.onChangeStroke(t.hex)},triangle:"hide"}))),r.a.createElement(tt.h,{inline:!0,label:"Stroke Width"},r.a.createElement(tt.s,{allowNumericCharactersOnly:!0,fill:!1,min:-1,onValueChange:function(t,n){return e.onChangeStrokeWidth(n)},placeholder:"Inherit",value:e.strokeWidth})))},Fa={clearAll:Kt,clearCurrent:en,collapseTreeNode:tn,expandTreeNode:nn,selectTreeNode:an,setFill:ln,setHeight:on,setLabelColor:sn,setLabelSize:cn,setRadius:un,setShape:hn,setStroke:dn,setStrokeWidth:fn,setWidth:pn,toggleCollapseNodeStyle:gn,toggleHideDisconnected:vn,toggleHideEmptySets:bn},Va=Object(s.b)((function(e){return Object(Qn.a)({},e.graphSlice.nodeStylingSlice)}),Fa)((function(e){var t=e.selected,n=!!e.selected&&e.hideDisconnected.get(e.selected),a=t&&e.shapes.get(t)||{},i=a?a.fill:void 0,l=a?a.stroke:void 0,o=a?a.strokeWidth:void 0,s=t&&e.labels.get(t)||{},c=s?s.color:void 0,u=s?s.font:void 0,h=u?u.match(/(\d*)px/):[],d=h&&h.length>1?parseInt(h[1]):void 0,f=xa(e.nodeTree,e.collapsed,t),p=e.hideEmptySets;return f.secondaryLabel=r.a.createElement(tt.C,{content:p?"Show Empty Sets":"Hide Empty Sets"},r.a.createElement(tt.a,{icon:p?"eye-off":"eye-open",minimal:!0,onClick:e.toggleHideEmptySets})),r.a.createElement(na.Section,{collapsed:e.collapseNodeStyle,onToggle:e.toggleCollapseNodeStyle,title:"Node Styling"},r.a.createElement(tt.D,{contents:[f],onNodeClick:function(t){return e.selectTreeNode(t.id.toString())},onNodeCollapse:function(t){return e.collapseTreeNode(t.id.toString())},onNodeExpand:function(t){return e.expandTreeNode(t.id.toString())}}),r.a.createElement(tt.g,null),t?r.a.createElement(r.a.Fragment,null,r.a.createElement(tt.h,{contentClassName:"fill",inline:!0},r.a.createElement(tt.y,{alignIndicator:ka.a.RIGHT,checked:n,onChange:e.toggleHideDisconnected,label:"Hide Disconnected Nodes"})),r.a.createElement(Na,{shape:a,onSetHeight:e.setHeight,onSetRadius:e.setRadius,onSetShape:e.setShape,onSetWidth:e.setWidth}),r.a.createElement(Aa,{fill:i,stroke:l,strokeWidth:o,onChangeFill:e.setFill,onChangeStroke:e.setStroke,onChangeStrokeWidth:e.setStrokeWidth}),r.a.createElement(Ea,{color:c,size:d,onChangeColor:e.setLabelColor,onChangeSize:e.setLabelSize}),r.a.createElement(tt.b,{fill:!0,minimal:!0},r.a.createElement(tt.a,{icon:"clean",onClick:e.clearCurrent,text:"Clear Selected"}),r.a.createElement(tt.a,{icon:"clean",onClick:e.clearAll,text:"Clear All"}))):r.a.createElement(tt.r,{title:"Node Styling",description:"Select a type or set from the tree",icon:"style"}))})),Pa=Object(s.b)((function(e){return{view:e.sterlingSlice.graphView}}))((function(e){return"node"===e.view?r.a.createElement(r.a.Fragment,null,r.a.createElement(_a,null),r.a.createElement(va,null),r.a.createElement(Va,null)):"edge"===e.view?r.a.createElement(r.a.Fragment,null,r.a.createElement(ra,null),r.a.createElement(wa,null)):"layout"===e.view?r.a.createElement(r.a.Fragment,null,r.a.createElement(La,null),r.a.createElement(fa,null),r.a.createElement(ga,null)):"settings"===e.view?r.a.createElement(r.a.Fragment,null,r.a.createElement(Ma,null),r.a.createElement(sa,null)):null})),Ia=n(88);var za=[],Wa=[{nodes:[],shape:{type:"circle"}}],Ha=Object(s.b)((function(e){return{asAttribute:e.graphSlice.dataSlice.asAttribute,bundleFactor:e.graphSlice.graphSettingsSlice.bundleFactor,description:e.sterlingSlice.welcomeDescription,edgeLabelPlacement:e.graphSlice.graphSettingsSlice.edgeLabelPlacement,edgeLabels:e.graphSlice.edgeStylingSlice.labelStyles,graph:e.graphSlice.graphSlice.graph,hideDisconnected:e.graphSlice.nodeStylingSlice.hideDisconnected,instance:e.sterlingSlice.instance,links:e.graphSlice.edgeStylingSlice.linkStyles,nodeLabels:e.graphSlice.nodeStylingSlice.labels,projections:e.graphSlice.dataSlice.projections,shapes:e.graphSlice.nodeStylingSlice.shapes,settings:e.graphSlice.graphSettingsSlice,title:e.sterlingSlice.welcomeTitle}})),Ba=new Map;var Ga=Ha(function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e)))._ref=void 0,n._ref=r.a.createRef(),n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this._ref.current,t=this.props,n=t.graph,a=t.instance;a&&this._update(n,a),e&&this.props.graph.canvas(e),n.update()}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.graph,a=t.instance,i=!(!e.instance||!a)&&function(e,t){var n=new Set;e.atoms().forEach((function(e){e.type().isBuiltin()||n.add(e.id())}));for(var a=t.atoms(),i=0;i<a.length;++i){var r=a[i];if(!r.type().isBuiltin()&&n.has(r.id()))return!0}return!1}(e.instance,a);(a&&this._update(n,a),i||Ba.clear(),!e.instance||a&&!i)&&(new N).apply(n,{nodesep:100,rankdir:"BT",ranksep:150});n.update()}},{key:"render",value:function(){var e=this.props;return this.props.instance?r.a.createElement("canvas",{className:"graph",ref:this._ref}):r.a.createElement(tt.r,{title:e.title,description:e.description,icon:"graph"})}},{key:"_buildEdgeStyles",value:function(){var e=this.props.instance,t=this.props.links,n=this.props.edgeLabels;if(!e)return za;var a=e.fields(),i=e.skolems().filter((function(e){return e.arity()>1})),r=function(e){var a=e.id();return{groups:[a],link:t.get(a),label:n.get(a)}};return[{groups:[],link:t.get("Fields"),label:n.get("Fields"),children:a.map(r)},{groups:[],link:t.get("Skolems"),label:n.get("Skolems"),children:i.map(r)}]}},{key:"_buildNodeStyles",value:function(){var e=this.props.instance,t=this.props.shapes,n=this.props.nodeLabels;if(!e)return Wa;var a=e.signatures().find((function(e){return"univ"===e.id()}));if(!a)return Wa;var i=function e(a){var i=a.subTypes().map(e),r=t.get(a.id()),l=n.get(a.id());return{nodes:a.atoms().map((function(e){return e.name()})),shape:r?x(r):void 0,label:l?ne(l):void 0,children:i}}(a);return i.shape||(i.shape={}),i.shape.type||(i.shape.type="rectangle"),[i]}},{key:"_update",value:function(e,t){var n=this.props,a=n.settings;if(t){var i=function(e,t,n,a,i,r){var l=Object(Se.b)(e.signatures().map((function(t){var n,i=t.id();return a.has(i)?[t,(n=a.get(i),e.atoms().find((function(e){return e.name()===n})))]:[t,void 0]}))),o=Object(Se.b)(e.fields().map((function(e){return[e,e.tuples().map(y).filter(Ia.isDefined).filter(v)]}))).filter((function(e){return e.length>0})),s=Object(Se.b)(e.skolems().map((function(e){return[e,e.tuples().map(y).filter(Ia.isDefined).filter(v)]}))).filter((function(e){return e.length>0})),c=o.filter((function(e,t){return!b(t)&&e[0].arity()>1})),u=o.filter((function(e,t){return b(t)||1===e[0].arity()})),h=s.filter((function(e){return e[0].arity()>1})),d=s.filter((function(e){return 1===e[0].arity()})),f=[],g=Object(Se.c)().withMutations((function(e){function t(t,n){var a=n.atoms(),i=a[0],r=a[a.length-1],l=a.slice(1,a.length-1),o=t.name()+(l.length?" [".concat(l.join(", "),"]"):"");e.add(i),e.add(r),f.push({source:i.name(),target:r.name(),group:t.id(),label:o})}c.forEach((function(e,n){e.forEach((function(e){return t(n,e)}))})),h.forEach((function(e,n){e.forEach((function(e){return t(n,e)}))}))})),m=Object(Se.b)().withMutations((function(e){function t(t,n){Object(Se.b)().withMutations((function(e){t.forEach((function(t){var n=t.atoms(),a=n[0],i=n.slice(1).map((function(e){return e.name()})).join("->");e.has(a)||e.set(a,[]),i.length&&e.get(a).push(i)}))})).forEach((function(t,a){var i="field"===n.expressionType()&&!b(n),r=t.length?": ".concat(t.join(", ")):"",l="".concat(n.name()).concat(r);e.has(a)||e.set(a,[]),e.get(a).push(i?"(".concat(l,")"):l)}))}u.forEach(t),d.forEach(t)}));return[e.atoms().map((function(e){var a=e.type();if(g.has(e)||!r.get(a.id())){var i=t.find((function(t){return t.id===e.name()}))||n.get(e.name())||{id:e.name(),x:0,y:0};return i.labels=m.get(e),i}})).filter(Ia.isDefined),f];function v(e){return e.arity()>0}function b(e){return!!i.get(e.id())}function y(e){var t=e.types().map(_).map((function(e){return l.get(e)}));if(!t.some(Ia.isDefined))return e;var n=e.atoms();return n.every((function(e,n){return void 0===t[n]||t[n]===e}))?new p.b(e.id(),n.filter((function(e,n){return void 0===t[n]}))):void 0}function _(e){return e.typeHierarchy()[1]}}(t,e.nodes(),Ba,n.projections,n.asAttribute,n.hideDisconnected),r=Object(w.a)(i,2),l=r[0],o=r[1];l.forEach((function(e){return Ba.set(e.id,e)})),e.nodes(l),e.edges(o),e.bundleFactor(n.bundleFactor),e.edgeLabelPlacement(n.edgeLabelPlacement),e.nodeStyles(this._buildNodeStyles()),e.edgeStyles(this._buildEdgeStyles())}else e.nodes([]),e.edges([]);e.axesVisible(a.axesVisible),e.gridVisible(a.gridVisible);var s=this._ref.current;s&&this.props.graph.canvas(s)}}]),t}(r.a.Component)),qa=n(1),Za={setMainView:we},Ua=Object(s.b)((function(e){return{view:e.sterlingSlice.mainView}}),Za)((function(e){return r.a.createElement(tt.o.Group,null,r.a.createElement(tt.q,{className:"nav-heading"},"Sterling"),r.a.createElement(tt.p,null),r.a.createElement(tt.a,{active:"graph"===e.view,className:qa.a.MINIMAL,icon:"graph",large:!0,text:"Graph",onClick:function(){return e.setMainView("graph")}}),r.a.createElement(tt.a,{active:"table"===e.view,className:qa.a.MINIMAL,icon:"th",large:!0,text:"Table",onClick:function(){return e.setMainView("table")}}),r.a.createElement(tt.a,{active:"source"===e.view,className:qa.a.MINIMAL,icon:"document",large:!0,text:"Source",onClick:function(){return e.setMainView("source")}}),r.a.createElement(tt.p,null))})),Qa={setInstance:Oe},Xa=(Object(s.b)((function(e){return{instance:e.sterlingSlice.instance}}),Qa)((function(e){var t=e.instance?e.instance.command():"",n=r.a.createRef(),a=function(t){if("string"===typeof t&&t.length)try{var n=new p.a(t);e.setInstance(n)}catch(a){e.setInstance(null)}else e.setInstance(null)},i=function(e){fetch(e).then((function(e){return e.text()})).then(a).catch((function(){return a(null)}))};return r.a.createElement(tt.o,{fixedToTop:!0,className:"nav bp3-dark"},r.a.createElement(Ua,null),r.a.createElement(tt.o.Group,{className:"collapsing"},t.length>0&&r.a.createElement(tt.z,{minimal:!0},t),r.a.createElement(tt.p,null),r.a.createElement("input",{type:"file",style:{display:"none"},onChange:function(){if(n.current){var e=n.current.files;if(e&&e.length){var t=e[0],i=new FileReader;i.addEventListener("load",(function(e){a(e.target?e.target.result:null)})),i.readAsText(t)}}},ref:n}),r.a.createElement(tt.t,null,r.a.createElement(tt.a,{rightIcon:"caret-down",intent:"success",large:!0,text:"Open"}),r.a.createElement(tt.l,null,r.a.createElement(tt.n,{text:"Open XML...",onClick:function(){n.current&&n.current.click()}}),r.a.createElement(tt.m,{title:"Examples"}),r.a.createElement(tt.n,{text:"Finite Element Mesh",onClick:function(){return i("examples/mesh.xml")}}),r.a.createElement(tt.n,{text:"Geneaology",onClick:function(){return i("examples/genealogy.xml")}}),r.a.createElement(tt.n,{text:"Mathematical Matrix",onClick:function(){return i("examples/matrix.xml")}}),r.a.createElement(tt.n,{text:"River Crossing Puzzle",onClick:function(){return i("examples/river-crossing.xml")}}),r.a.createElement(tt.n,{text:"Wetting and Drying",onClick:function(){return i("examples/wetdry.xml")}})))))})),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e)))._requestNext=function(){n.props.connection.requestNextInstance()},n.state={command:"",connected:!1,ready:!1},n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.connection.addEventListener("connect",(function(){e.setState({connected:!0})})).addEventListener("disconnect",(function(){e.setState({connected:!1,ready:!1})})).addEventListener("instance",(function(t){e.setState({command:t.instance.command(),ready:e.state.connected})}))}},{key:"render",value:function(){var e=this.state;return r.a.createElement(tt.o,{fixedToTop:!0,className:"nav bp3-dark"},r.a.createElement(Ua,null),r.a.createElement(tt.o.Group,{className:"collapsing"},e.command.length>0&&r.a.createElement(tt.z,{minimal:!0},e.command),r.a.createElement(tt.p,null),r.a.createElement(tt.a,{disabled:!e.ready,intent:e.connected?"success":"danger",large:!0,onClick:this._requestNext,rightIcon:"circle-arrow-right",text:"Next"})))}}]),t}(r.a.Component)),Ya={setSelected:xn},Ja=Object(s.b)((function(e){return{instance:e.sterlingSlice.instance,selected:e.sourceSlice.selected}}),Ya),$a=function(e){return r.a.createElement(tt.r,{title:"No Files",icon:"document"})},Ka=Ja((function(e){var t=e.instance;return r.a.createElement(na.Section,{title:"Model Sources"},t?r.a.createElement(tt.b,{alignText:ka.a.LEFT,minimal:!0,vertical:!0}," ",t.sources().map((function(t){return r.a.createElement(tt.a,{active:e.selected===t,icon:"document",key:t.filename(),onClick:function(){return e.setSelected(t)},text:t.filename().split(/(\\|\/)/g).pop()})}))):r.a.createElement($a,e))})),ei=n(905),ti=n(901),ni=n(123),ai=ti.a;ei.a.registerLanguage("alloy",(function(){return{case_insensitive:!1,keywords:"abstract all and as assert but check disj else exactly expect extends fact for fun iden iff implies in Int let lone module no none not one open or pred run set sig some sum univ",contains:[Object(ni.COMMENT)("//","$",{}),Object(ni.COMMENT)("--","$",{}),Object(ni.COMMENT)("/\\*","\\*/",{}),{className:"number",begin:"\\b\\d+",relevance:0}]}}));var ii=Object(s.b)((function(e){return{instance:e.sterlingSlice.instance,selected:e.sourceSlice.selected,welcome:e.sterlingSlice.welcomeTitle,welcomeDescription:e.sterlingSlice.welcomeDescription}}))((function(e){return e.instance?e.selected?r.a.createElement(ei.a,{className:"source",language:"alloy",showLineNumbers:!1,style:ai},e.selected.source()):r.a.createElement(tt.r,{description:"Choose a File",icon:"document",title:e.welcome}):r.a.createElement(tt.r,{description:e.welcomeDescription,icon:"document",title:e.welcome})})),ri=n(903).a.ofType();function li(e,t){var n=0,a=t.split(/\s+/).filter((function(e){return e.length>0})).map(oi);if(0===a.length)return[e];for(var r=new RegExp(a.join("|"),"gi"),l=[];;){var o=r.exec(e);if(!o)break;var s=o[0].length,c=e.slice(n,r.lastIndex-s);c.length>0&&l.push(c),n=r.lastIndex,l.push(i.createElement("strong",{key:n},o[0]))}var u=e.slice(n);return u.length>0&&l.push(u),l}function oi(e){return e.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1")}var si=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r))))._filterItem=function(e,t){return("field"===t.expressionType()?n.props.nameFunction(t).split("<:")[1]:n.props.nameFunction(t)).toLowerCase().indexOf(e.toLowerCase())>=0},n._isItemSelected=function(e){return n.props.itemsSelected.includes(e)},n._onRemoveTag=function(e,t){n.props.onDeselectItem(n.props.itemsSelected[t])},n._onSelectItem=function(e){n._isItemSelected(e)?n.props.onDeselectItem(e):n.props.onSelectItem(e)},n._renderItem=function(e,t){if(!t.modifiers.matchesPredicate)return null;switch(e.expressionType()){case"signature":return n._renderSignature(e,t);case"field":return n._renderField(e,t);case"skolem":return n._renderSkolem(e,t);default:return null}},n._renderList=function(e){var t=e.items.filter((function(e){return"signature"===e.expressionType()})),a=e.items.filter((function(e){return"field"===e.expressionType()})),r=e.items.filter((function(e){return"skolem"===e.expressionType()})),l=p.d.alphabeticalSort(n.props.nameFunction);t.sort(l).sort(p.d.builtinSort()),a.sort(l),r.sort(l);var o=t.map(e.renderItem).filter((function(e){return null!=e})),s=a.map(e.renderItem).filter((function(e){return null!=e})),c=r.map(e.renderItem).filter((function(e){return null!=e}));return i.createElement(tt.l,{ulRef:e.itemsParentRef},i.createElement(tt.m,{title:"Signatures"}),o.length?o:i.createElement(tt.n,{disabled:!0,text:"None"}),i.createElement(tt.m,{title:"Fields"}),s.length?s:i.createElement(tt.n,{disabled:!0,text:"None"}),i.createElement(tt.m,{title:"Skolems"}),c.length?c:i.createElement(tt.n,{disabled:!0,text:"None"}))},n._renderSignature=function(e,t){var a=n._isItemSelected(e);return i.createElement(tt.n,{active:t.modifiers.active,disabled:t.modifiers.disabled,key:e.id(),labelElement:li(n.props.nameFunction(e),t.query),icon:a?"tick":"blank",onClick:t.handleClick})},n._renderField=function(e,t){var a=n.props.nameFunction(e).split("<:"),r=n._isItemSelected(e);return i.createElement(tt.n,{active:t.modifiers.active,disabled:t.modifiers.disabled,key:e.id(),icon:i.createElement(i.Fragment,null,r&&i.createElement(tt.k,{icon:"tick"}),i.createElement(nt,{signature:a[0]})),labelElement:li(a[1],t.query),onClick:t.handleClick})},n._renderSkolem=function(e,t){var a=n._isItemSelected(e);return i.createElement(tt.n,{active:t.modifiers.active,disabled:t.modifiers.disabled,icon:a?"tick":"blank",key:e.id(),labelElement:li(e.name(),t.query),onClick:t.handleClick})},n._renderTag=function(e){var t=n.props.nameFunction(e);return"field"===e.expressionType()?at.FieldTagEls(t.split("<:")):t},n._tagProps=function(e,t){var a=n.props.itemsSelected[t].expressionType();return{className:"signature"===a?"sig-tag":"field"===a?"field-tag":"skolem"===a?"skolem-tag":""}},n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=this.props.itemsSelected.length?i.createElement(tt.a,{icon:"cross",minimal:!0,onClick:this.props.onClearSelectedItems}):void 0;return i.createElement(ri,{fill:!0,items:function(t){var n=t.filter((function(e){return"signature"===e.expressionType()})),a=t.filter((function(e){return"field"===e.expressionType()})),i=t.filter((function(e){return"skolem"===e.expressionType()})),r=p.d.alphabeticalSort(e.props.nameFunction);return n.sort(r).sort(p.d.builtinSort()),a.sort(r),i.sort(r),[].concat(Object(J.a)(n),Object(J.a)(a),Object(J.a)(i))}(t.items),itemPredicate:this._filterItem,itemRenderer:this._renderItem,itemListRenderer:this._renderList,onItemSelect:this._onSelectItem,popoverProps:{usePortal:!1},placeholder:"Choose Tables...",resetOnSelect:!0,scrollToActiveItem:!0,selectedItems:this.props.itemsSelected,tagInputProps:{onRemove:this._onRemoveTag,rightElement:n,tagProps:this._tagProps},tagRenderer:this._renderTag})}}]),t}(i.Component),ci={clearSelectedData:Dn,deselectData:Rn,selectData:Nn,setAlignment:An,setLayoutDirection:Fn,setSort:Vn,setTableTypes:Pn,toggleCollapseData:In,toggleCollapseLayout:zn,toggleCollapseTables:Wn,toggleHighlightSkolems:Hn,toggleRemoveBuiltin:Bn,toggleRemoveEmpty:Gn,toggleRemoveThis:qn},ui=Object(s.b)((function(e){return Object(Qn.a)({},e.tableSlice)}),ci)((function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(na.Section,{collapsed:e.collapseTables,onToggle:e.toggleCollapseTables,style:{position:"relative",zIndex:1},title:"Tables"},r.a.createElement(tt.w,{onChange:function(t){return e.setTableTypes(parseInt(t.currentTarget.value))},selectedValue:e.tablesType},r.a.createElement(tt.v,{label:"All Tables",value:Xt.All}),r.a.createElement(tt.v,{label:"Signatures",value:Xt.Signatures}),r.a.createElement(tt.v,{label:"Fields",value:Xt.Fields}),r.a.createElement(tt.v,{label:"Skolems",disabled:e.highlightSkolems,value:Xt.Skolems}),r.a.createElement(tt.v,{label:"Choose Tables",value:Xt.Select}),r.a.createElement(si,{items:e.data,itemsSelected:e.dataSelected,onClearSelectedItems:e.clearSelectedData,onDeselectItem:e.deselectData,onSelectItem:e.selectData,nameFunction:wn(e.removeThis)}))),r.a.createElement(na.Section,{collapsed:e.collapseData,onToggle:e.toggleCollapseData,style:{position:"relative",zIndex:0},title:"Data Options"},r.a.createElement(tt.y,{alignIndicator:ka.a.LEFT,checked:e.removeBuiltin,disabled:e.tablesType===Xt.Select,label:"Hide Built-in Signatures",onChange:e.toggleRemoveBuiltin}),r.a.createElement(tt.y,{alignIndicator:ka.a.LEFT,checked:e.removeEmpty,disabled:e.tablesType===Xt.Select,label:"Hide Empty Tables",onChange:e.toggleRemoveEmpty}),r.a.createElement(tt.y,{alignIndicator:ka.a.LEFT,checked:e.removeThis,label:'Remove "this" from Signature names',onChange:e.toggleRemoveThis}),r.a.createElement(tt.y,{alignIndicator:ka.a.LEFT,checked:e.highlightSkolems,label:"Display Skolems as highlighted rows",onChange:e.toggleHighlightSkolems})),r.a.createElement(na.Section,{collapsed:e.collapseLayout,onToggle:e.toggleCollapseLayout,style:{position:"relative",zIndex:0},title:"Layout Options"},r.a.createElement(tt.h,{inline:!0,label:"Layout Direction"},r.a.createElement(tt.b,null,r.a.createElement(tt.a,{active:e.layoutDirection===Zt.Row,icon:"vertical-distribution",onClick:function(){return e.setLayoutDirection(Zt.Row)}}),r.a.createElement(tt.a,{active:e.layoutDirection===Zt.Column,icon:"horizontal-distribution",onClick:function(){return e.setLayoutDirection(Zt.Column)}}))),r.a.createElement(tt.h,{inline:!0,label:"Align"},r.a.createElement(tt.b,null,r.a.createElement(tt.a,{active:e.alignment===qt.Left,icon:"align-left",onClick:function(){return e.setAlignment(qt.Left)}}),r.a.createElement(tt.a,{active:e.alignment===qt.Center,icon:"align-center",onClick:function(){return e.setAlignment(qt.Center)}}),r.a.createElement(tt.a,{active:e.alignment===qt.Right,icon:"align-right",onClick:function(){return e.setAlignment(qt.Right)}}))),r.a.createElement(tt.h,{inline:!0,label:"Sort"},r.a.createElement(tt.b,null,r.a.createElement(tt.a,{icon:"group-objects",onClick:function(){e.setSort({method:Qt.Group,direction:Ut.Ascending})}}),r.a.createElement(tt.a,{icon:"sort-alphabetical",onClick:function(){e.setSort({method:Qt.Alphabetical,direction:Ut.Ascending})}}),r.a.createElement(tt.a,{icon:"sort-alphabetical-desc",onClick:function(){e.setSort({method:Qt.Alphabetical,direction:Ut.Descending})}}),r.a.createElement(tt.a,{icon:"sort-numerical",onClick:function(){e.setSort({method:Qt.Size,direction:Ut.Ascending})}}),r.a.createElement(tt.a,{icon:"sort-numerical-desc",onClick:function(){e.setSort({method:Qt.Size,direction:Ut.Descending})}})))))})),hi=n(121),di=n(899),fi=n(900),pi=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).state={enabled:!1},n._buildShadowStyle=function(e,t){return e.map((function(e,n){return"0 0 0 ".concat((n+1)*t,"px ").concat(e)})).join(",")},n._onMouseEnter=function(){n.setState({enabled:!0})},n._onMouseLeave=function(){n.setState({enabled:!1})},n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.props.colors,n=this.state.enabled?4:2;return r.a.createElement(hi.c,null,r.a.createElement(di.a,null,(function(a){var i=a.ref;return r.a.createElement("tr",{onMouseEnter:e._onMouseEnter,onMouseLeave:e._onMouseLeave,ref:i,style:{boxShadow:e._buildShadowStyle(t,n)}},e.props.children)})),r.a.createElement(tt.u,null,r.a.createElement(fi.a,{modifiers:{},placement:"right"},(function(a){var i=a.ref,l=a.style,o=a.placement;return e.state.enabled&&r.a.createElement("div",{ref:i,style:Object(Qn.a)({},l,{padding:n*(t.length-1)+"px"}),"data-placement":o},r.a.createElement("div",{className:"table-rowpop"},e.props.content))}))))}}]),t}(r.a.Component);function gi(e,t){return r.a.createElement(r.a.Fragment,null,e.map((function(e,n){return r.a.createElement("div",{key:e.id(),style:{backgroundColor:t[n]}},e.name())})))}var mi=Object(s.b)((function(e){return Object(Qn.a)({},e.tableSlice,{description:e.sterlingSlice.welcomeDescription,instance:e.sterlingSlice.instance,title:e.sterlingSlice.welcomeTitle})}))((function(e){if(!e.instance)return r.a.createElement(tt.r,{title:e.title,description:e.description,icon:"th"});var t=function(e){return e===qt.Left?"left":e===qt.Center?"center":e===qt.Right?"right":""}(e.alignment),n=function(e){return e===Zt.Row?"row":e===Zt.Column?"column":""}(e.layoutDirection),a=wn(e.removeThis),i=Cn(e.primarySort,a),l=Cn(e.secondarySort,a),o=e.tablesType,s=o===Xt.All?e.data:o===Xt.Signatures?e.data.filter(p.c.keepSignatures):o===Xt.Fields?e.data.filter(p.c.keepFields):o===Xt.Skolems?e.data.filter(p.c.keepSkolems):o===Xt.Select?e.dataSelected.slice():[],c=function(){return!0};return s=(s=o===Xt.Select?s:s.filter(e.removeBuiltin?p.c.removeBuiltins:c).filter(e.removeEmpty?p.c.removeEmptys:c).filter(e.highlightSkolems?p.c.removeSkolems:c)).sort(l).sort(i),r.a.createElement("div",{className:"tables ".concat(t," ").concat(n)},s.map((function(t){return r.a.createElement(tt.d,{key:t.id(),elevation:1},function(e,t){if("signature"===e.expressionType())return r.a.createElement(nt,{fill:!0,signature:e,nameFunction:t});if("field"===e.expressionType())return r.a.createElement(at,{fill:!0,field:e,nameFunction:t});if("skolem"===e.expressionType())return r.a.createElement(it,{fill:!0,skolem:e,nameFunction:t});return null}(t,a),"signature"===t.expressionType()?function(e){var t=e.signature.atoms();return r.a.createElement(tt.j,{bordered:!0,condensed:!0,striped:!0},r.a.createElement("tbody",null,t.map((function(t){var n=t.skolems();if(e.highlightSkolems&&n.length){var a=n.map((function(t){return e.skolemColors.get(t)||""}));return r.a.createElement(pi,{key:t.id(),content:gi(n,a),colors:a},r.a.createElement("td",null,t.name()))}return r.a.createElement("tr",{key:t.id()},r.a.createElement("td",null,t.name()))}))))}({highlightSkolems:e.highlightSkolems,signature:t,skolemColors:e.skolemColors}):"field"===t.expressionType()?function(e){var t=e.field.types(),n=e.field.tuples();return r.a.createElement(tt.j,{bordered:!0,condensed:!0,striped:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,t.map((function(t,n){return r.a.createElement("th",{key:t.id()+n},e.nameFunction(t))})))),r.a.createElement("tbody",null,n.map((function(t){var n=t.skolems();if(e.highlightSkolems&&n.length){var a=n.map((function(t){return e.skolemColors.get(t)||""}));return r.a.createElement(pi,{key:t.id(),content:gi(n,a),colors:a},t.atoms().map((function(e,n){return r.a.createElement("td",{key:t.id()+"["+n+"]"},e.name())})))}return r.a.createElement("tr",{key:t.id()},t.atoms().map((function(e,n){return r.a.createElement("td",{key:t.id()+"["+n+"]"},e.name())})))}))))}({field:t,highlightSkolems:e.highlightSkolems,nameFunction:a,skolemColors:e.skolemColors}):"skolem"===t.expressionType()?function(e){var t=e.skolem.types(),n=e.skolem.tuples();return r.a.createElement(tt.j,{bordered:!0,condensed:!0,striped:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,t.map((function(t,n){return r.a.createElement("th",{key:t.id()+n},e.nameFunction(t))})))),r.a.createElement("tbody",null,n.map((function(e){return r.a.createElement("tr",{key:e.id()},e.atoms().map((function(t,n){return r.a.createElement("td",{key:e.id()+"["+n+"]"},t.name())})))}))))}({nameFunction:a,skolem:t}):null)})))})),vi=n(282),bi={TOGGLE_AXES:"shift+a",TOGGLE_GRID:"shift+g",VIEW_GRAPH:"g",VIEW_SOURCE:"s",VIEW_TABLE:"t",ZOOM_TO_FIT:"f",ZOOM_TO_HOME:"h"},yi={setMainView:we,toggleAxesVisible:wt,toggleGridVisible:Tt},_i=Object(s.b)((function(e){return Object(Qn.a)({},e)}),yi)(function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,i=new Array(a),r=0;r<a;r++)i[r]=arguments[r];return(n=Object(u.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i))))._handlers=function(){return{TOGGLE_AXES:function(){"graph"===n.props.sterlingSlice.mainView&&n.props.toggleAxesVisible()},TOGGLE_GRID:function(){"graph"===n.props.sterlingSlice.mainView&&n.props.toggleGridVisible()},VIEW_GRAPH:function(){n.props.setMainView("graph")},VIEW_SOURCE:function(){n.props.setMainView("source")},VIEW_TABLE:function(){n.props.setMainView("table")},ZOOM_TO_FIT:function(){"graph"===n.props.sterlingSlice.mainView&&n.props.graphSlice.graphSlice.graph.zoomToFit()},ZOOM_TO_HOME:function(){"graph"===n.props.sterlingSlice.mainView&&n.props.graphSlice.graphSlice.graph.zoomToHome()}}},n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement(vi.HotKeys,{className:"sterling",keyMap:bi,handlers:this._handlers()},this.props.children)}}]),t}(r.a.Component)),ki={setGraphView:je,setMainView:we,setSourceView:Ce,setTableView:Me},Si=Object(s.b)((function(e){return Object(Qn.a)({},e.sterlingSlice)}),ki),Ei=function(e){return r.a.createElement(tt.C,{content:r.a.createElement("span",null,e.text),hoverOpenDelay:500,intent:$n.a.PRIMARY,position:ba.a.RIGHT},r.a.createElement(tt.a,{icon:e.icon,minimal:!0,large:!0,active:e.active,onClick:e.click}))},xi=function(e){var t=e.graphView;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ei,{active:"node"===t,click:function(){return e.setGraphView("node")},icon:"group-objects",text:"Projections and Node Styling"}),r.a.createElement(Ei,{active:"edge"===t,click:function(){return e.setGraphView("edge")},icon:"flows",text:"Edge Styling"}),r.a.createElement(Ei,{active:"layout"===t,click:function(){return e.setGraphView("layout")},icon:"layout-auto",text:"Layout"}),r.a.createElement(Ei,{active:"settings"===t,click:function(){return e.setGraphView("settings")},icon:"settings",text:"Graph Settings"}))},ji=function(e){return r.a.createElement(Ei,{active:"settings"===e.tableView,click:function(){return e.setTableView("settings")},icon:"settings",text:"Table Settings"})},Oi=function(e){return r.a.createElement(Ei,{active:"files"===e.sourceView,click:function(){return e.setSourceView("files")},icon:"document",text:"Model Sources"})},wi=Si((function(e){var t=e.mainView,n="graph"===t&&"evaluator"===e.graphView||"table"===t&&"evaluator"===e.tableView||"source"===t&&"evaluator"===e.sourceView;return r.a.createElement("div",{className:"sidebar nav bp3-dark"},"graph"===t?r.a.createElement(xi,e):"table"===t?r.a.createElement(ji,e):"source"===t?r.a.createElement(Oi,e):null,r.a.createElement("div",{className:"divider"}),r.a.createElement(Ei,{active:n,click:function(){"graph"===t&&e.setGraphView("evaluator"),"table"===t&&e.setTableView("evaluator"),"source"===t&&e.setSourceView("evaluator")},icon:"console",text:"Evaluator"}))})),Ci=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"stage"},this.props.children)}}]),t}(r.a.Component);Xn.a.onlyShowFocusOnTabs();var Mi={setInstance:Oe},Ti=Object(s.b)((function(e){return Object(Qn.a)({graph:e.graphSlice.graphSlice.graph},e.sterlingSlice)}),Mi)(function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(h.a)(t).call(this,e)))._evaluator=void 0,n._evaluatorView=void 0,n._getDrawer=function(){var e=n.props,t=n._evaluatorView,a="graph"===e.mainView&&"evaluator"===e.graphView||"table"===e.mainView&&"evaluator"===e.tableView||"source"===e.mainView&&"evaluator"===e.sourceView;return r.a.createElement(na,null,a?r.a.createElement(t,{evaluator:n._evaluator}):"graph"===e.mainView?r.a.createElement(Pa,null):"table"===e.mainView?r.a.createElement(ui,null):"source"===e.mainView?r.a.createElement(Ka,null):null)},n._getNavbar=function(){return r.a.createElement(Xa,{connection:n.props.connection})},n._getStage=function(){var e=n.props.mainView;return r.a.createElement(Ci,null,"table"===e?r.a.createElement(mi,null):"graph"===e?r.a.createElement(Ga,null):"source"===e?r.a.createElement(ii,null):null)},n._initializeConnection=function(){var e=n.props.connection;e.addEventListener("connect",(function(){e.requestCurrentInstance()})),e.addEventListener("instance",(function(e){n.props.setInstance(e.instance)})),e.connect()},n._resize=function(){n.props.graph.resize()},n._evaluator=new Jn(e.connection),n._evaluatorView=ea,n.state={instance:null},n}return Object(d.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this._initializeConnection()}},{key:"render",value:function(){var e=this.props,t="graph"===e.mainView&&null!==e.graphView||"table"===e.mainView&&null!==e.tableView||"source"===e.mainView&&null!==e.sourceView;return r.a.createElement(tt.x,{onResize:this._resize},r.a.createElement(_i,null,this._getNavbar(),r.a.createElement(wi,null),t?r.a.createElement(Yn.a,{split:"vertical",defaultSize:350,minSize:150,maxSize:-150,onChange:this._resize},this._getDrawer(),this._getStage()):this._getStage()))}}]),t}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(885);var Li=new v,Di=Object(a.createStore)(Un);o.a.render(r.a.createElement(s.a,{store:Di},r.a.createElement(Ti,{connection:Li})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[320,1,2]]]);
//# sourceMappingURL=main.06fe14cb.chunk.js.map